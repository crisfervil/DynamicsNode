<html>
<head>
</head>
<body style="background: transparent;">
    <script src="scripts/docstrap.lib.js"></script>
    <script src="scripts/lunr.min.js"></script>
    <script src="scripts/fulltext-search.js"></script>

    <script type="text/x-docstrap-searchdb">
    {"DataTable.js.html":{"id":"DataTable.js.html","title":"Source: DataTable.js","body":" DynamicsNode Classes CRMClientDataTableFetchFilterGuidWhoAmIResponse Tutorials CommandsAndReplCompileAndTesting Global Global Source: DataTable.js &quot;use strict&quot;; var path = require(&quot;path&quot;); var fs = require(&quot;fs&quot;); var XMLWriter = require('xml-writer'); var et = require('elementtree'); var debug = require(&quot;debug&quot;)(&quot;dynamicsnode&quot;); var DataTable = (function () { /** Default constructor * @class DataTable * @classdesc Represents a DataTable object. Contains methods to save and load the row values from a file. */ function DataTable(name, rows) { this.name = name; this.rows = []; if (rows !== undefined) { this.rows = rows; } } DataTable.prototype.lookup = function (columnName, updater) { for (var i = 0; i &lt; this.rows.length; i++) { var currentRow = this.rows[i]; var value = updater(currentRow); currentRow[columnName] = value; } }; /** The path is relative to process.cwd() */ DataTable.prototype.save = function (fileName) { var strValue; var ext = path.extname(fileName); if (ext != null) ext = ext.toLowerCase(); if (ext == &quot;.json&quot;) { debug(&quot;Serializing to json...&quot;); strValue = JSON.stringify(this, null, 4); } else if (ext == &quot;.xml&quot;) { debug(&quot;Serializing to xml...&quot;); strValue = this.serializeXml(this); } else { throw new Error(&quot;Format \\&quot;&quot; + ext + &quot;\\&quot; not supported&quot;); } if (strValue != null) { debug(&quot;About to write &quot; + strValue.length + &quot; bytes to file...&quot;); fs.writeFileSync(fileName, strValue); } }; /** The path is relative to process.cwd() */ DataTable.load = function (fileName) { var dt; var ext = path.extname(fileName); if (ext != null) ext = ext.toLowerCase(); var strContent = fs.readFileSync(fileName, &quot;utf8&quot;); if (ext == &quot;.json&quot;) { dt = JSON.parse(strContent, this.JSONDataReviver); if (dt &amp;&amp; dt.rows === undefined) throw &quot;The parsed file doesn't look like a DataTable&quot;; } else if (ext == &quot;.xml&quot;) { dt = this.parseXml(strContent); } else { throw new Error(&quot;Format \\&quot;&quot; + ext + &quot;\\&quot; not supported&quot;); } return dt; }; DataTable.parseNumbers = function (str) { var result = null; // http://stackoverflow.com/questions/18082/validate-decimal-numbers-in-javascript-isnumeric var isNumber = !Array.isArray(str) &amp;&amp; (+str - parseFloat(str) + 1) &gt;= 0; if (isNumber) { result = +str; } return result; }; ; DataTable.parseBooleans = function (str) { var result = null; if (/^(?:true|false)$/i.test(str)) { result = str.toLowerCase() === 'true'; } return result; }; ; DataTable.parseDates = function (str) { var result = null; var dateParts = /^(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.*(\\d*)Z$/.exec(str); if (dateParts !== null) { result = new Date(Date.UTC(+dateParts[1], +dateParts[2] - 1, +dateParts[3], +dateParts[4], +dateParts[5], +dateParts[6], +dateParts[7])); } return result; }; DataTable.parseValue = function (str) { var result = str; if (typeof str === 'string') { var parsedValue = DataTable.parseBooleans(str); if (parsedValue === null) { parsedValue = DataTable.parseNumbers(str); } if (parsedValue === null) { parsedValue = DataTable.parseDates(str); } if (parsedValue !== null) { result = parsedValue; } } return result; }; DataTable.JSONDataReviver = function (key, str) { var result = str; if (typeof str === 'string' || str instanceof String) { var parsedValue = DataTable.parseDates(str); if (parsedValue !== null) { result = parsedValue; } } return result; }; ; DataTable.parseXml = function (xmlContent) { var dt = new DataTable(); var etree = et.parse(xmlContent); var rootElement = etree.getroot(); var attrName = rootElement.attrib[&quot;name&quot;]; if (attrName) dt.name = attrName; var rowElements = rootElement.getchildren(); for (var i = 0; i &lt; rowElements.length; i++) { var rowElement = rowElements[i]; var rowItem = {}; var rowFieldElements = rowElement.getchildren(); for (var j = 0; j &lt; rowFieldElements.length; j++) { var rowFieldElement = rowFieldElements[j]; var fieldName = rowFieldElement.tag; var fieldValue = rowFieldElement.text; var fieldType = rowFieldElement.attrib[&quot;type&quot;]; var parsedValue = DataTable.parseXmlValue(fieldValue); if (fieldType) { parsedValue = { type: fieldType, value: parsedValue }; } rowItem[fieldName] = parsedValue; } dt.rows.push(rowItem); } return dt; }; DataTable.parseXmlValue = function (strValue) { var result = strValue; var parsedValue = DataTable.parseBooleans(strValue); if (parsedValue === null) { parsedValue = DataTable.parseNumbers(strValue); } if (parsedValue === null) { parsedValue = DataTable.parseDates(strValue); } if (parsedValue !== null) { result = parsedValue; } return result; }; DataTable.prototype.serializeXml = function (data) { var returnValue; if (DataTable != null) { var xw = new XMLWriter(true); xw.startElement('DataTable'); if (this.name) xw.writeAttribute(&quot;name&quot;, this.name); for (var i = 0; i &lt; data.rows.length; i++) { xw.startElement('row'); var rowItem = data.rows[i]; for (var propName in rowItem) { var propValue = rowItem[propName]; if (propValue != null) { xw.startElement(propName); var strValue; if (typeof propValue == &quot;object&quot; &amp;&amp; !(propValue instanceof Date) &amp;&amp; propValue.type) { // this value must contain typeinfo xw.writeAttribute(&quot;type&quot;, propValue.type); strValue = this.serializeValue(propValue.value); } else { strValue = this.serializeValue(propValue); } xw.text(strValue); xw.endElement(); } } xw.endElement(); // row } xw.endElement(); // DataTable returnValue = xw.toString(); } return returnValue; }; DataTable.prototype.serializeValue = function (value) { var result = value.toString(); if (value != null &amp;&amp; value instanceof Date) { result = JSON.stringify(value).replace(/\\&quot;/g, &quot;&quot;); } return result; }; return DataTable; }()); exports.DataTable = DataTable; × Search results Close "},"CRMClient.js.html":{"id":"CRMClient.js.html","title":"Source: CRMClient.js","body":" DynamicsNode Classes CRMClientDataTableFetchFilterGuidWhoAmIResponse Tutorials CommandsAndReplCompileAndTesting Global Global Source: CRMClient.js &quot;use strict&quot;; var DataTable_1 = require(&quot;./DataTable&quot;); var Guid_1 = require(&quot;./Guid&quot;); var Fetch_1 = require(&quot;./Fetch&quot;); var Dictionary_1 = require(&quot;./Dictionary&quot;); var Messages_1 = require(&quot;./Messages&quot;); var CRMDataTypes_1 = require(&quot;./CRMDataTypes&quot;); var path = require(&quot;path&quot;); var edge = require(&quot;edge&quot;); var debug = require(&quot;debug&quot;)(&quot;dynamicsnode&quot;); var debugQueries = require(&quot;debug&quot;)(&quot;dynamicsnode:queries&quot;); var CRMClient = (function () { /** * Default constructor * @classdesc Allow access to CRM functions. Contains the functions to interact with CRM services. * @class CRMClient * @param {string} connectionString Optional. A valid connection string or connection string name. * The connection string can be either a valid connection string or a name of an existing connection string in the file &quot;config.json&quot; at the root path of your application. * If no value is passed to the constructor, the &quot;default&quot; text will be assumed, which means that a connection string named &quot;default&quot; will be used. * @see {@link https://msdn.microsoft.com/en-us/library/gg695810.aspx} for further information * * @example &lt;caption&gt;config.json file format&lt;/caption&gt; * { * &quot;connectionStrings&quot;: * { * &quot;default&quot;:&quot;Url=http://crm.contoso.com/xrmContoso; Domain=CONTOSO; Username=jsmith; Password=passcode&quot;, * &quot;connection2&quot;:&quot;Url=http://crm.contoso.com/xrmContoso&quot; * } * } * @example &lt;caption&gt;Create a connection using a valid Connection String&lt;/caption&gt; * var crm = new CRMClient(&quot;Url=http://crm.contoso.com/xrmContoso; Domain=CONTOSO; Username=jsmith; Password=passcode&quot;); * @example &lt;caption&gt;Create a connection using the connection string named &quot;connection2&quot; specified in the config.json file&lt;/caption&gt; * var crm = new CRMClient(&quot;connection2&quot;); * @example &lt;caption&gt;Create a connection using the connection string named &quot;default&quot; specified in the config.json file&lt;/caption&gt; * var crm = new CRMClient(); * @example &lt;caption&gt;Create a connection using the connection string named &quot;default&quot; specified in the config.json file&lt;/caption&gt; * var crm = new CRMClient(&quot;default&quot;); */ function CRMClient(connectionString, fakeBridge) { if (connectionString === void 0) { connectionString = &quot;default&quot;; } if (fakeBridge === void 0) { fakeBridge = false; } this.connectionString = connectionString; this._metadataCache = new Dictionary_1.Dictionary(); var config = this.tryGetModule(path.join(process.cwd(), &quot;config.json&quot;)); if (config &amp;&amp; config.connectionStrings &amp;&amp; config.connectionStrings[connectionString]) { this.connectionString = config.connectionStrings[connectionString]; } this._crmBridge = this.getBridge(fakeBridge); this.testConnection(); } /** * Gets the bridge object between node and .net * @private * @method CRMClient#getBridge * @param fakeBridge {boolean} indicates if a fake bridge whants to be retrieved * @returns a .net bridge that allows node to interact with .net */ CRMClient.prototype.getBridge = function (fakeBridge) { var source = path.join(__dirname, &quot;CRMBridge.cs&quot;); var ref1 = path.join(__dirname, &quot;bin/Microsoft.Crm.Sdk.Proxy.dll&quot;); var ref2 = path.join(__dirname, &quot;bin/Microsoft.Xrm.Client.dll&quot;); var ref3 = path.join(__dirname, &quot;bin/Microsoft.Xrm.Sdk.dll&quot;); var ref4 = path.join(&quot;System.Runtime.Serialization.dll&quot;); var ref5 = path.join(__dirname, &quot;bin/Newtonsoft.Json.dll&quot;); var createBridge = edge.func({ source: source, references: [ref1, ref2, ref3, ref4, ref5] }); var bridge = createBridge({ connectionString: this.connectionString, useFake: fakeBridge }, true); return bridge; }; CRMClient.prototype.tryGetModule = function (moduleId) { var result = null; try { result = require(moduleId); } catch (e) { } return result; }; CRMClient.prototype.convert = function (propertiesArray) { var converted = null; if (propertiesArray) { converted = {}; for (var i = 0; i &lt; propertiesArray.length; i++) { var propValue = propertiesArray[i]; if (propValue[1] instanceof Array) { var convertedValues = []; for (var j = 0; i &lt; propValue[1].length; i++) { var arrayItem = propValue[1][j]; convertedValues.push(this.convert(arrayItem)); } converted[propValue[0]] = convertedValues; } else { converted[propValue[0]] = propValue[1]; } } } return converted; }; /** * Returns information about the current user. Useful for testing the active connection. * @returns a {@link WhoAmIResponse} object with the information about the authenticated user in CRM. * @method CRMClient#whoAmI * @example &lt;caption&gt;Returns information about the current user&lt;/caption&gt; * var who = crm.whoAmI(); * console.log(who.BusinessUnitId); // prints 6fefeb79-5447-e511-a5db-0050568a69e2 * console.log(who.OrganizationId); // prints 2b476bd1-aaed-43ee-b386-eee0f1b87207 * console.log(who.UserId); // prints 9ba35c25-b892-4f8a-b124-3920d9873af4 */ CRMClient.prototype.whoAmI = function () { var request = new Messages_1.WhoAmIRequest(); var response = this.Execute(request); return response; }; /** * Tests the active connection. Throws an exception if there's any error. * The method performs a {@link WhoAmIRequest}. * @method CRMClient#testConnection * @see CRMClient#whoAmI */ CRMClient.prototype.testConnection = function () { try { this.whoAmI(); // Performs a who am i request } catch (e) { var error = new Error(); throw new Error(&quot;Error trying to connect to server\\n&quot; + JSON.stringify(e)); } }; /** * Retrieves one single record from CRM. * @method CRMClient#retrieve * @param entityName {string} Name of the entity to be retrieved. The name is case insensitive, so all values are lowercased before being sent to CRM. * @param idOrConditions {string|Guid|object} Either a string with the GUID if the record to be retrieved, a {@link Guid} object with the same value, or a conditions object that returns only one record. * Learn how to write condition objects: {@link Fetch#setFilter} * @param attributes {string|string[]|boolean} Optional. Either an attribute name, an array of attributes, or a true value indicating that all attributes must be retrieved. The default value is true. An ***** value has the same effect * * @returns A javascript object containing the values of the record. If no data found, then a null object is returned. * * @example &lt;caption&gt;Return all the columns for the specified account id&lt;/caption&gt; * var account = crm.retrieve(&quot;account&quot;,&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;); * console.log(account); * @example &lt;caption&gt;Return all the columns for the specified account id&lt;/caption&gt; * var account = crm.retrieve(&quot;account&quot;,&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;,&quot;*&quot;); * console.log(account); * @example &lt;caption&gt;Return all the columns for the specified account id&lt;/caption&gt; * var account = crm.retrieve(&quot;account&quot;,&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;,true); * console.log(account); * @example &lt;caption&gt;You can use the Guid class to specify the id parameter. This allows to perform a GUID format validation before calling the method.&lt;/caption&gt; * var Guid = require(&quot;dynamicsnode&quot;).Guid; * var account = crm.retrieve(&quot;account&quot;,new Guid(&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;)); * console.log(account); * @example &lt;caption&gt;Get the accountid,name,ownerid,createdon columns for the given account id&lt;/caption&gt; * var account = crm.retrieve(&quot;account&quot;,&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;,[&quot;accountid&quot;,&quot;name&quot;,&quot;ownerid&quot;,&quot;createdon&quot;]); * console.log(account); * @example &lt;caption&gt;Get the name of the specified account&lt;/caption&gt; * var account = crm.retrieve(&quot;account&quot;,&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;,&quot;name&quot;); * console.log(account.name); * @example &lt;caption&gt;Accessing information about a related record&lt;/caption&gt; * var account = crm.retrieve(&quot;account&quot;,&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;,&quot;ownerid&quot;); * console.log(account.ownerid); // outputs the GUID value * console.log(account.ownerid_type); // outputs systemuser * console.log(account.ownerid_name); // outputs John Doe * @example &lt;caption&gt;Returns an account using a condition object. If there are more than one account named &quot;Acme&quot; then an exception will be thrown&lt;/caption&gt; * var account = crm.retrieve(&quot;account&quot;,{name:&quot;Acme&quot;}); * console.log(account.name); */ CRMClient.prototype.retrieve = function (entityName, idOrConditions, pColumns) { var idValue; var result; var columns; if (!entityName) throw &quot;Entity name not specified&quot;; if (!idOrConditions) throw &quot;Id or Conditions not specified&quot;; entityName = entityName.toLocaleLowerCase(); // normalize casing // validate columns if (pColumns === undefined) { columns = true; // default value } else { columns = pColumns; if (typeof pColumns == &quot;string&quot;) { columns = [pColumns]; } if (Array.isArray(columns)) { for (var i = 0; i &lt; columns.length; i++) { columns[i] = columns[i].toLocaleLowerCase(); // normalize casing; } } } if (idOrConditions instanceof Guid_1.Guid) { idValue = idOrConditions.getValue(); } else if (typeof idOrConditions === &quot;string&quot; || idOrConditions instanceof String) { idValue = idOrConditions; if (!Guid_1.Guid.isGuid(idValue)) throw &quot;Invalid GUID value&quot;; } else if (typeof idOrConditions === &quot;object&quot;) { // Assume a conditions objet was passed // Get the records that meet the specified criteria var idField = this.getIdField(entityName); var foundRecords = this.retrieveMultiple(entityName, idOrConditions, idField); if (foundRecords.rows !== null) { if (foundRecords.rows.length &gt; 1) throw new Error(&quot;Too many records found matching the specified criteria&quot;); if (foundRecords.rows.length &gt; 0) { // TODO: Refactor to avoid querying CRM twice idValue = foundRecords.rows[0][idField]; } } } else { throw new Error(&quot;invalid idOrConditions type value&quot;); } if (idValue) { var params = { entityName: entityName, id: idValue, columns: columns }; var retrieveResult; try { retrieveResult = this._crmBridge.Retrieve(params, true); } catch (ex) { var rethrow = false; if (ex.Detail &amp;&amp; ex.Detail.InnerFault &amp;&amp; ex.Detail.InnerFault.Message) { // Record with specified Id doesn't exists var msg = entityName + &quot; With Id = &quot; + idValue.toLowerCase().replace(&quot;{&quot;, &quot;&quot;).replace(&quot;}&quot;, &quot;&quot;) + &quot; Does Not Exist&quot;; if (ex.Detail.InnerFault.Message != msg) rethrow = true; } if (rethrow) throw ex; } // convert the result to a js object if (retrieveResult != null) { result = this.convert(retrieveResult); } } return result; }; /** * Retrieves one or more records of the specified entity that fulfill the specified conditions. * @method CRMClient#retrieveMultiple * * @param entityNameOrFetchXml {string} Name of the entity or Fetch Xml query to specify the records to be retrieved. More info: {@link https://msdn.microsoft.com/en-us/library/gg328332.aspx} * @param conditions {object} Optional. In case you don't want to write a FetchXml to specify the records to retrieve, you can use a conditions object to specify the criteria to retrieve records. If you omit this parameter, all the existing records of the specified entity will be retrieved; omitting this parameter is equivalent to write a FetchXml without any filter conditions. * Learn how to write condition objects: {@link Fetch#setFilter} * @param attributes {string|string[]|boolean} Optional. Either an attribute name, an array of attributes, or a true value indicating that all attributes must be retrieved. The default value is true. An ***** value has the same effect * @returns {DataTable} {@link DataTable} object with the records found. * * @see Build queries with FetchXML: {@link https://msdn.microsoft.com/en-us/library/gg328332.aspx} * * @example &lt;caption&gt;Retrieves all the records of the account entity. Only the accountid column will be retrieved (the id column is always returned in all Crm queries)&lt;/caption&gt; * var accounts = crm.retrieveMultiple(&quot;&lt;fetch&gt;&lt;entity name='account'&gt;&lt;/entity&gt;&lt;/fetch&gt;&quot;); * @example &lt;caption&gt;Retrieves all the records of the account entity. Includes also all the columns of the entity.&lt;/caption&gt; * var accounts = crm.retrieveMultiple(&quot;account&quot;); * @example &lt;caption&gt;Retrieves all the records of the account entity where the account name is equals to &quot;contoso&quot;. Returns all the columns of the entity.&lt;/caption&gt; * var accounts = crm.retrieveMultiple(&quot;account&quot;,{name:&quot;contoso&quot;}); * @example &lt;caption&gt;Retrieves all the records of the account entity where the account name is equals to &quot;contoso&quot;, but only the specified columns are included in the query.&lt;/caption&gt; * var accounts = crm.retrieveMultiple(&quot;account&quot;,{name:&quot;contoso&quot;},[&quot;accountid&quot;,&quot;name&quot;,&quot;ownerid&quot;,&quot;createdon&quot;]); * @example &lt;caption&gt;Retrieves all the records of the account entity where the account name is equals to &quot;contoso&quot; or &quot;acme&quot;. Returns all the columns of the entity.&lt;/caption&gt; * var accounts = crm.retrieveMultiple(&quot;account&quot;,{name:[&quot;contoso&quot;,&quot;acme&quot;]}); * */ CRMClient.prototype.retrieveMultiple = function (entityNameOrFetchXml, conditions, attributes) { var result = new Array(); var fetchXml; if (!(conditions || attributes)) { // No conditions or attributes were specified, means a FetchXml value is expected. // TODO: Improve this. could use a regular expression to distinguish between an xml and an entity name? fetchXml = entityNameOrFetchXml; } else { var fetch = new Fetch_1.Fetch(entityNameOrFetchXml); if (conditions) { fetch.setFilter(conditions); } if (attributes) { fetch.setAttributes(attributes); } fetchXml = fetch.toString(); debugQueries(fetchXml); } var retrieveResult = this._crmBridge.RetrieveMultiple(fetchXml, true); for (var i = 0; i &lt; retrieveResult.length; i++) { var record = retrieveResult[i]; var convertedRecod = this.convert(record); result.push(convertedRecod); } var dt = new DataTable_1.DataTable(entityNameOrFetchXml, result); return dt; }; /** It is a simpified way of retrieving all the existing records of an entity. Is equivalent to call the {@link CRMClient#retrieveMultiple} method not specifying the conditions or attributes method * @method CRMClient#retrieveAll * @param entityName {string} Name of the entity which records you want to retrieve. * @returns {DataTable} {@link DataTable} object with the records found. * @example &lt;caption&gt;Retrieve all existing account records&lt;/caption&gt; * var accounts = crm.retrieveAll(&quot;account&quot;); */ CRMClient.prototype.retrieveAll = function (entityName) { var fetch = new Fetch_1.Fetch(entityName, &quot;*&quot;); var fetchXml = fetch.toString(); var result = this.retrieveMultiple(fetchXml); return result; }; /** * Creates a record in CRM. The names in the entity or attributes are case insensitive, so all the names will be lowercased before send the operation to Crm. * @method CRMClient#create * @param entityName {string} The name of the entity which record you want to create * @param attributes {object} Javascript object with the values the new record will have. * * @returns {string} GUID of the record created. * * @example &lt;caption&gt;Create an account named &quot;Contoso&quot;&lt;/caption&gt; * var accountid = crm.create(&quot;account&quot;,{name:&quot;contoso&quot;,description:&quot;this is a test&quot;,AccountCategoryCode:1}); * console.log(accountid); */ CRMClient.prototype.create = function (entityName, attributes) { // perform some validations if (!entityName) throw &quot;Entity name not specified&quot;; if (!attributes) throw &quot;Attributes not specified&quot;; entityName = entityName.toLocaleLowerCase(); // normalize casing var values = new Array(); for (var prop in attributes) { values.push(prop.toLocaleLowerCase()); // normalize casing values.push(attributes[prop]); } var params = { entityName: entityName, values: values }; var createdGuid = this._crmBridge.Create(params, true); return createdGuid; }; /** * Deletes one on more records in CRM, and returns the number of records affected. * @method CRMClient#delete * @param entityName {string} Name of the entity which record you want to delete * @param idsOrConditions {string|Guid|string[]|object} Can be either a Guid, a string, an array or a conditions object. * If it is Guid will delete the record with the specified id. * If it is a string, must be a Guid value, and again, will delete the records matching the specified id. * If the parameter is an array, each element in it must be either a string or a Guid, and in each case, the records deleted will be the ones specified by these Guids. * If it is a condition object, first, all the matching records will be retrieved, and then deleted. * Learn how to write condition objects: {@link Fetch#setFilter} * @returns {number} Number of records deleted * @example &lt;caption&gt;Delete an account with a known Guid&lt;/caption&gt; * var affectedRecords = crm.delete(&quot;account&quot;,&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;); * @example &lt;caption&gt;Delete an account with a known Guid. A validation of the Guid format will be performed before calling to the method.&lt;/caption&gt; * var affectedRecords = crm.delete(&quot;account&quot;,new Guid(&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;)); * @example &lt;caption&gt;Delete several account records at once&lt;/caption&gt; * var affectedRecords = crm.delete(&quot;account&quot;,[&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;,&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;); * @example &lt;caption&gt;Delete all existing accounts named &quot;contoso&quot;&lt;/caption&gt; * var affectedRecords = crm.delete(&quot;account&quot;,{name:&quot;contoso&quot;}); */ CRMClient.prototype.delete = function (entityName, idsOrConditions) { var ids; var recordsAffected = 0; if (!entityName) throw &quot;Entity name not specified&quot;; entityName = entityName.toLowerCase(); // normalize casing if (idsOrConditions instanceof Guid_1.Guid) { ids = [idsOrConditions.getValue()]; } else if (typeof idsOrConditions == &quot;string&quot;) { if (!Guid_1.Guid.isGuid(idsOrConditions)) throw &quot;Invalid GUID value&quot;; ids = [idsOrConditions]; } else if (Array.isArray(ids)) { for (var i = 0; i &lt; ids.length; i++) { var item = ids[i]; if (!(item instanceof Guid_1.Guid) || Guid_1.Guid.isGuid(item)) { throw &quot;Invalid GUID&quot;; } } ids = idsOrConditions; } else if (typeof idsOrConditions == &quot;object&quot; &amp;&amp; !(idsOrConditions instanceof Date)) { // Get the records that meet the specified criteria var idField = this.getIdField(entityName); var foundRecords = this.retrieveMultiple(entityName, idsOrConditions, idField); ids = []; for (var i = 0; i &lt; foundRecords.rows.length; i++) { ids.push(foundRecords.rows[i][idField]); } } recordsAffected = this.deleteMultiple(entityName, ids); return recordsAffected; }; CRMClient.prototype.deleteMultiple = function (entityName, ids) { var recordsAffected = 0; for (var i = 0; i &lt; ids.length; i++) { var params = { entityName: entityName, id: ids[i] }; this._crmBridge.Delete(params, true); recordsAffected++; } return recordsAffected; }; /** * Updates one or more records that meet the specified conditions and returns the number of updated records. * @method CRMClient#update * @param entityName {string} The name of the entity which record you want to update. * @param attributes {object} Javascript object with the values the new record will have. * @param conditions {opbject} Optional. Javascript condition object with the filter values that is going to be used to know which records are going to be updated. * If you omit this parameter, then you have to provide the record GUID in the attributes parameter. * Learn how to write condition objects: {@link Fetch#setFilter} * @returns {number} Number of modified records * * @example &lt;caption&gt;Updates all the accounts which name is contoso, and set the attribute value to &quot;contoso-updated&quot;&lt;/caption&gt; * var affectedRecords = crm.update(&quot;account&quot;,{name:&quot;contoso-updated&quot;},{name:&quot;contoso&quot;}) * @example &lt;caption&gt;In this example, only the account with the specified account id will be updated. If the specified record id exists, then affectedRecords will be equals to 1.&lt;/caption&gt; * var affectedRecords = crm.update(&quot;account&quot;,{accountid:&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;,name:&quot;contoso-updated&quot;}) */ CRMClient.prototype.update = function (entityName, attributes, conditions) { var updatedRecordsCount = 0; var values = new Array(); if (!entityName) throw &quot;Entity name not specified&quot;; entityName = entityName.toLowerCase(); // normalize casing // prepare values for (var prop in attributes) { var attrName = prop.toLowerCase(); // normalize casing values.push(attrName); values.push(attributes[prop]); } // get records GUIDS if (conditions != undefined) { // The id field of an entity is always the entity name + &quot;id&quot; // TODO: Except for activities var idField = (entityName + &quot;id&quot;).toLowerCase(); var foundRecords = this.retrieveMultiple(entityName, conditions, idField); var idFieldIndex = values.indexOf(idField); if (idFieldIndex &lt; 0) { // Add the id field to the values array and save the attribute index idFieldIndex = values.push(idField) - 1; values.push(null); } for (var i = 0; i &lt; foundRecords.rows.length; i++) { var foundRecordId = foundRecords.rows[i][idField]; values[idFieldIndex + 1] = foundRecordId; var params = { entityName: entityName, values: values }; this._crmBridge.Update(params, true); } updatedRecordsCount = foundRecords.rows.length; } else { // the attributes parameter must contain the entity id on it var params = { entityName: entityName, values: values }; this._crmBridge.Update(params, true); updatedRecordsCount = 1; } return updatedRecordsCount; }; CRMClient.prototype.getIdField = function (entityName) { var idAttr = null; var metadata = this.getEntityMetadata(entityName); if (metadata) { // Find the primary Attribute idAttr = metadata.PrimaryIdAttribute; } if (idAttr == null) throw &quot;Primary Attribute not found for entity &quot; + entityName; debug(&quot;idAttr for entity '&quot; + entityName + &quot;': '&quot; + idAttr + &quot;'&quot;); // convert it to lowercase return idAttr.toLowerCase(); }; /** Takes a list of attributes and values, tries to find an existing record with those values in CRM, if it exists, then performs an update, otherwhise it creates it. * @method CRMClient#createOrUpdate * @param entityName {string} Name of the entity which record you want to update. * @param attributes {object} Javascript object with the attributes you want to create or update. * @param matchFields {string[]} List of fields in the attributes parameter you want to use to know if the record exists in CRM. * The attributes specified in this parameter will be used to perform a {@link CRMClient#retrieve}. * @example &lt;caption&gt;Create an account named &quot;contoso&quot;. In this case, a retrieve of an account with name=&quot;contoso&quot; will be performed. If exists, then the name and description will be updated. If it doesn't exist, then the account will be created with the specified name and description. If theres more than one account with that name, an exception will be thrown&lt;/caption&gt; * crm.createOrUpdate(&quot;account&quot;,{name:&quot;contoso&quot;, description:&quot;Account Updated&quot;},[&quot;name&quot;]); * @example &lt;caption&gt;Searches for an account named &quot;contoso&quot; owned by me. If exists, it updates it, otherwhise it creates a new one.&lt;/caption&gt; * var me = crm.whoAmI().UserId; * crm.createOrUpdate(&quot;account&quot;,{name:&quot;contoso&quot;, description:&quot;Account Updated&quot;, ownerid:me},[&quot;name&quot;,&quot;ownerid&quot;]); */ CRMClient.prototype.createOrUpdate = function (entityName, attributes, matchFields) { var idField = this.getIdField(entityName); var conditions = {}; for (var i = 0; i &lt; matchFields.length; i++) { var matchField = matchFields[i]; if (attributes[matchField] !== undefined &amp;&amp; attributes[matchField] !== null) { conditions[matchField] = attributes[matchField]; } } // check if the record exists var foundRecord = this.retrieve(entityName, conditions, idField); if (foundRecord) { // The record exists. Update it attributes[idField] = foundRecord[idField]; this.update(entityName, attributes); } else { // The record doesn't exists. Create it this.create(entityName, attributes); } }; CRMClient.prototype.associateData = function (data) { for (var i = 0; i &lt; data.rows.length; i++) { var row = data.rows[i]; this.associate(row.from.type, row.from.value, data.name, row.to.type, row.to.value); } }; CRMClient.prototype.associate = function (fromEntityName, fromEntityId, relationshipName, toEntityName, toEntityId) { // perform some validations if (!fromEntityName) throw &quot;From entity name not specified&quot;; fromEntityName = fromEntityName.toLowerCase(); // normalize casing if (!toEntityName) throw &quot;To entity name not specified&quot;; toEntityName = toEntityName.toLowerCase(); // normalize casing if (!fromEntityId) throw &quot;fromEntityId not specified&quot;; if (!toEntityId) throw &quot;toEntityId not specified&quot;; var fromId, toId; if (fromEntityId instanceof Guid_1.Guid) { fromId = fromEntityId.getValue(); } else { fromId = fromEntityId; } if (toEntityId instanceof Guid_1.Guid) { toId = toEntityId.getValue(); } else { toId = toEntityId; } var params = { entityName: fromEntityName, entityId: fromId, relationship: relationshipName, relatedEntities: [{ entityName: toEntityName, entityId: toId }] }; this._crmBridge.Associate(params, true); }; CRMClient.prototype.disassociateData = function (data) { for (var i = 0; i &lt; data.rows.length; i++) { var row = data.rows[i]; this.disassociate(row.from.type, row.from.value, data.name, row.to.type, row.to.value); } }; CRMClient.prototype.disassociate = function (fromEntityName, fromEntityId, relationshipName, toEntityName, toEntityId) { // perform some validations if (!fromEntityName) throw &quot;From entity name not specified&quot;; fromEntityName = fromEntityName.toLowerCase(); // normalize casing if (!toEntityName) throw &quot;To entity name not specified&quot;; toEntityName = toEntityName.toLowerCase(); // normalize casing if (!fromEntityId) throw &quot;fromEntityId not specified&quot;; if (!toEntityId) throw &quot;toEntityId not specified&quot;; var fromId, toId; if (fromEntityId instanceof Guid_1.Guid) { fromId = fromEntityId.getValue(); } else { fromId = fromEntityId; } if (toEntityId instanceof Guid_1.Guid) { toId = toEntityId.getValue(); } else { toId = toEntityId; } var params = { entityName: fromEntityName, entityId: fromId, relationship: relationshipName, relatedEntities: [{ entityName: toEntityName, entityId: toId }] }; this._crmBridge.Disassociate(params, true); }; CRMClient.prototype.getEntityMetadata = function (entityName) { var ndx = this._metadataCache.indexOf(entityName); var metadata = null; if (ndx &gt; -1) { metadata = this._metadataCache.getValue(ndx); } else { metadata = this.getEntityMetadataFromCrm(entityName); this._metadataCache.push(entityName, metadata); } return metadata; }; CRMClient.prototype.getEntityMetadataFromCrm = function (entityName) { var params = { entityName: entityName }; var metadataStr = this._crmBridge.GetEntityMetadata(params, true); var metadata = JSON.parse(metadataStr); return metadata; }; CRMClient.prototype.Execute = function (request) { var response = this._crmBridge.Execute(request, true); return response; }; CRMClient.prototype.assign = function (targetId, targetType, assigneeId, assigneeType) { // set the default value if (assigneeType === undefined) assigneeType = &quot;systemuser&quot;; var request = new Messages_1.AssignRequest(); request.Assignee = new CRMDataTypes_1.EntityReference(assigneeId.toString(), assigneeType); request.Target = new CRMDataTypes_1.EntityReference(targetId.toString(), targetType); var response = this.Execute(request); }; CRMClient.prototype.export = function (entityName, fileName) { debug(&quot;Exporting &quot; + entityName + &quot; to &quot; + fileName + &quot;...&quot;); // perform some validations if (!entityName) throw &quot;Entity name not specified&quot;; entityName = entityName.toLowerCase(); // normalize casing debug(&quot;Getting metadata...&quot;); var metadata = this.getEntityMetadata(entityName); debug(&quot;Getting data...&quot;); var data = this.retrieveMultiple(entityName, {}); var rowsCount = data ? data.rows ? data.rows.length : 0 : 0; debug(&quot;Retrieved &quot; + rowsCount + &quot; records&quot;); debug(&quot;Saving...&quot;); data.save(fileName); debug(&quot;done!&quot;); }; CRMClient.prototype.import = function (fileName) { debug(&quot;Importing &quot; + fileName + &quot;...&quot;); debug(&quot;Loading data table...&quot;); var dt = DataTable_1.DataTable.load(fileName); debug(dt.rows.length + &quot; records found&quot;); debug(&quot;Getting metadata for entity &quot; + dt.name + &quot;...&quot;); var metadata = this.getEntityMetadata(dt.name); var idField = this.getIdField(dt.name); debug(&quot;Importing...&quot;); for (var i = 0; i &lt; dt.rows.length; i++) { debug(&quot;record &quot; + (i + 1) + &quot; of &quot; + dt.rows.length + &quot;...&quot;); this.createOrUpdate(dt.name, dt.rows[i], [idField]); } debug(&quot;done!&quot;); }; return CRMClient; }()); exports.CRMClient = CRMClient; × Search results Close "},"Fetch.js.html":{"id":"Fetch.js.html","title":"Source: Fetch.js","body":" DynamicsNode Classes CRMClientDataTableFetchFilterGuidWhoAmIResponse Tutorials CommandsAndReplCompileAndTesting Global Global Source: Fetch.js &quot;use strict&quot;; var XMLWriter = require('xml-writer'); var Fetch = (function () { /** Default Constructor * @class Fetch * @classdesc Provides properties and methods to create FetchXml queries * @param entityName {string} Optional. Name of the entity which the query is for * @param attr {string|boolean|string[]} Optional. Either a column name, or a list of column names, or a boolean value indicating that all the attribute values want to be retrieved. The default value is null, and means that only the primary attribute will be retrieved. * @param filterConditions {object} Optional. Object that describes conditions in an JSON notation. More Info: {@link Fetch#setFilter} * @example &lt;caption&gt;Create an empty FetchXml&lt;/caption&gt; * var fetch = new Fetch(); * console.log(fetch.toString()); // outputs: &lt;fetch&gt;&lt;entity&gt;&lt;/entity&gt;&lt;/fetch&gt; * @example &lt;caption&gt;Create a Fetch query for the &quot;account&quot;&quot; entity, with 3 attributes and one filter&lt;/caption&gt; * var fetch = new Fetch(&quot;account&quot;,[&quot;description&quot;,&quot;createdon&quot;,&quot;ownerid&quot;],{name:&quot;acme&quot;}); * @example &lt;caption&gt;Create a Fetch query for the &quot;account&quot;&quot; entity, with all attributes and one filter&lt;/caption&gt; * var fetch = new Fetch(&quot;account&quot;,true,{name:&quot;acme&quot;}); */ function Fetch(entityName, attr, filterConditions) { this.entityName = entityName; this.attributes = []; this.operatorNames = ['eq', 'neq', 'gt', 'ge', 'le', 'lt', 'like', 'not-like', 'in', 'not-in', 'between', 'not-between', 'null', 'not-null']; this.operatorJsonNames = ['$eq', '$neq', '$gt', '$ge', '$le', '$lt', '$like', '$notlLike', '$in', '$notIn', '$between', '$notBetween', &quot;&quot;, /*'null'*/, &quot;&quot; /* 'not-null'*/]; if (this.attributes != undefined) this.setAttributes(attr); if (filterConditions != undefined) this.setFilter(filterConditions); } Fetch.prototype.toString = function () { var xw = new XMLWriter(true); xw.startElement('fetch'); xw.startElement('entity'); if (this.entityName) { xw.writeAttribute('name', this.entityName.toLowerCase()); } this.serializeAttributes(this.attributes, xw); this.serializeConditions(this.filter, xw); xw.endDocument(); return xw.toString(); }; Fetch.prototype.serializeAttributes = function (value, writer) { for (var i = 0; i &lt; value.length; i++) { var attr = value[i].toLowerCase(); if (attr == &quot;*&quot;) { writer.startElement(&quot;all-attributes&quot;); } else { writer.startElement(&quot;attribute&quot;); writer.writeAttribute(&quot;name&quot;, attr); } writer.endElement(); } }; /** * Sets the filter criteria of the current &lt;i&gt;FetchXml&lt;/i&gt; with the specified values. * * The specified value can be eiher a {@link Filter} object or a conditions object. * * A conditions object is a Javascript object where every property represents a condition. * * If the object contains a property, and that property contains a simple value, like an string or a number, that means property equals to value. * * If you need to specify another operator, then you have to use the form: {attribute:{$operator:value}} * * If the value is an array, then the $in operator is used. * * If the value is a null value, then the nulloperator is applied. For example: {name:null} will retrieve all the records where the name is null. * * @method Fetch#setFilter * @param filterCondition {Filter|object} A Filter object or a Conditions specified in JSON notation. * * @see Build queries with FetchXML: {@link https://msdn.microsoft.com/en-us/library/gg328332.aspx} * * @example &lt;caption&gt;When the simple syntax is used {name:value} then the $eq operator is used. The following filter retrieves all records where the attribute &lt;i&gt;name&lt;/i&gt; is equals to &quot;myAccount&quot;&lt;/caption&gt; * var cond = {name:&quot;myAccount&quot;}; * @example &lt;caption&gt;The following retrieves all records where the attribute &lt;i&gt;name&lt;/i&gt; is equals to &quot;myAccount&quot; &lt;b&gt;AND&lt;/b&gt; the createdon date is equals to the system date&lt;/caption&gt; * var cond = {name:&quot;myAccount&quot;, createdon:new Date()} * @example &lt;caption&gt;If you need to specify additional operators, then use a subobject with the operator name. The following retrieves all records where the attribute &lt;i&gt;name&lt;/i&gt; begins with &quot;contoso%&quot; and the attribute &lt;i&gt;createdon&lt;/i&gt; is bigger than the current date&lt;/caption&gt; * var cond = {name:{$like:&quot;contoso%&quot;}, createdon:{$bt:new Date()}} * @example &lt;caption&gt;Currently supported operators:&lt;/caption&gt; * $eq, $neq, $gt, $ge, $le, $lt, $like, $notlLike, $in, $notIn, $between, $notBetween * @example &lt;caption&gt;If the value is an array, then the &lt;i&gt;in&lt;/i&gt; operator is applied. The wollowing means: where name is one of contoso, acme or cycleworks&lt;/caption&gt; * var cond = {name:[&quot;contoso&quot;, &quot;acme&quot;, &quot;cycleworks&quot;]}; * @example &lt;caption&gt;To specify the null operator, use a null value next to the attribute name. The following will retrieve all the records where the name is null.&lt;/caption&gt; * var cond = {name:null}; */ Fetch.prototype.setFilter = function (filterConditions) { if (filterConditions != null) { if (filterConditions instanceof Filter) { this.filter = filterConditions; } else { this.filter = this.convert(filterConditions); } } }; Fetch.prototype.setAttributes = function (attributes) { if (attributes == null) { this.attributes = []; } else { if (Array.isArray(attributes)) { this.attributes = attributes; } else if (typeof attributes == &quot;string&quot;) { this.attributes = [attributes]; } else if (typeof attributes == &quot;boolean&quot;) { this.attributes = [&quot;*&quot;]; } } }; Fetch.prototype.serializeValue = function (value) { var strValue = &quot;&quot;; if (value !== null &amp;&amp; value !== undefined) { if (value instanceof Date) { var dateValue = value; // TODO: Refactor this awful code var pad2 = function (x) { return String(&quot;00&quot; + x).slice(-2); }; strValue = dateValue.getUTCFullYear() + &quot;-&quot; + pad2(dateValue.getUTCMonth()) + &quot;-&quot; + pad2(dateValue.getUTCDate()) + &quot; &quot; + pad2(dateValue.getUTCHours()) + &quot;:&quot; + pad2(dateValue.getUTCMinutes()) + &quot;:&quot; + pad2(dateValue.getUTCSeconds()); } else { strValue = value + &quot;&quot;; } } return strValue; }; Fetch.prototype.serializeConditions = function (filter, writer) { if (filter &amp;&amp; filter.conditions &amp;&amp; filter.conditions.length &gt; 0) { var filterTypeName = FilterTypes[filter.filterType].toLowerCase(); writer.startElement(&quot;filter&quot;).writeAttribute(&quot;type&quot;, filterTypeName); for (var i = 0; i &lt; filter.conditions.length; i++) { var filterCondition = filter.conditions[i]; var operatorName = this.operatorNames[filterCondition.operator]; var attributeName = filterCondition.attribute.toLowerCase(); writer.startElement(&quot;condition&quot;) .writeAttribute(&quot;attribute&quot;, attributeName) .writeAttribute(&quot;operator&quot;, operatorName); if (filterCondition.values &amp;&amp; filterCondition.values.length &gt; 0) { if (filterCondition.operator == Operators.In || filterCondition.operator == Operators.NotIn || filterCondition.values.length &gt; 1) { for (var j = 0; j &lt; filterCondition.values.length; j++) { var strValue = this.serializeValue(filterCondition.values[j]); writer.startElement(&quot;value&quot;).text(strValue).endElement(); } } else { var strValue = this.serializeValue(filterCondition.values[0]); writer.writeAttribute(&quot;value&quot;, strValue); } } writer.endElement(); // condition; } writer.endElement(); // filter; } }; Fetch.prototype.convert = function (conditionExpression) { var filter = new Filter(); for (var propName in conditionExpression) { var propValue = conditionExpression[propName]; if (propValue == null) { filter.conditions.push(new Condition(propName, Operators.Null)); } else if (typeof propValue === 'number' || propValue instanceof Number || typeof propValue === 'string' || propValue instanceof String || typeof propValue === 'boolean' || propValue instanceof Date) { filter.conditions.push(new Condition(propName, Operators.Equal, [propValue])); } else if (Array.isArray(propValue)) { filter.conditions.push(new Condition(propName, Operators.In, propValue)); } else if (typeof propValue === 'object' &amp;&amp; !(propValue instanceof Date)) { for (var i = 0; i &lt; this.operatorJsonNames.length; i++) { var operatorName = this.operatorJsonNames[i]; if (operatorName &amp;&amp; propValue[operatorName] != undefined) { propValue = propValue[operatorName]; if (Array.isArray(propValue)) { filter.conditions.push(new Condition(propName, i, propValue)); } else { filter.conditions.push(new Condition(propName, i, [propValue])); } break; } } } } return filter; }; return Fetch; }()); exports.Fetch = Fetch; /** * Filter Type Values * @typedef {object} FilterTypes * @property {number} And Indicates that all the values in the conditions must be true * @property {number} Or Indicates that only one of the conditions must be true */ (function (FilterTypes) { FilterTypes[FilterTypes[&quot;And&quot;] = 0] = &quot;And&quot;; FilterTypes[FilterTypes[&quot;Or&quot;] = 1] = &quot;Or&quot;; })(exports.FilterTypes || (exports.FilterTypes = {})); var FilterTypes = exports.FilterTypes; var Filter = (function () { /** * Default Constructor * @class Filter * @classdesc Describes a Filter in a {@link Fetch} query. */ /** @member Filter#conditions {Condition[]} Contains the conditions of this filter */ /** @member Filter#filterType {FilterTypes} Indicates if the filter is an And or Or filter */ function Filter(conditions, filterType) { this.conditions = conditions; this.filterType = filterType; if (this.conditions == null) this.conditions = new Array(); if (this.filterType == null) this.filterType = FilterTypes.And; } return Filter; }()); exports.Filter = Filter; // https://msdn.microsoft.com/en-us/library/gg309405.aspx (function (Operators) { Operators[Operators[&quot;Equal&quot;] = 0] = &quot;Equal&quot;; Operators[Operators[&quot;NotEqual&quot;] = 1] = &quot;NotEqual&quot;; Operators[Operators[&quot;GreaterThan&quot;] = 2] = &quot;GreaterThan&quot;; Operators[Operators[&quot;GreaterEqual&quot;] = 3] = &quot;GreaterEqual&quot;; Operators[Operators[&quot;LessEqual&quot;] = 4] = &quot;LessEqual&quot;; Operators[Operators[&quot;LessThan&quot;] = 5] = &quot;LessThan&quot;; Operators[Operators[&quot;Like&quot;] = 6] = &quot;Like&quot;; Operators[Operators[&quot;NotLike&quot;] = 7] = &quot;NotLike&quot;; Operators[Operators[&quot;In&quot;] = 8] = &quot;In&quot;; Operators[Operators[&quot;NotIn&quot;] = 9] = &quot;NotIn&quot;; Operators[Operators[&quot;Between&quot;] = 10] = &quot;Between&quot;; Operators[Operators[&quot;NotBetween&quot;] = 11] = &quot;NotBetween&quot;; Operators[Operators[&quot;Null&quot;] = 12] = &quot;Null&quot;; Operators[Operators[&quot;NotNull&quot;] = 13] = &quot;NotNull&quot;; })(exports.Operators || (exports.Operators = {})); var Operators = exports.Operators; var Condition = (function () { function Condition(attribute, operator, values) { this.attribute = attribute; this.operator = operator; this.values = values; } return Condition; }()); exports.Condition = Condition; × Search results Close "},"Guid.js.html":{"id":"Guid.js.html","title":"Source: Guid.js","body":" DynamicsNode Classes CRMClientDataTableFetchFilterGuidWhoAmIResponse Tutorials CommandsAndReplCompileAndTesting Global Global Source: Guid.js &quot;use strict&quot;; var Guid = (function () { /** * Default constructor * @classdesc Provides methos to generate an validate GUID values and to convert them from and to a String. * @class Guid * @param {string} string value representing a Guid Value */ function Guid(guid) { if (guid === undefined) { this.value = Guid.EMPTY; } else { if (Guid.isGuid(guid)) { this.value = guid; } else { throw new Error(&quot;Invalid GUID value&quot;); } } } Guid.gen = function (count) { var out = &quot;&quot;; for (var i = 0; i &lt; count; i++) { out += (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1); } return out; }; Guid.prototype.equals = function (other) { // Comparing string `value` against provided `guid` will auto-call // toString on `guid` for comparison if (other instanceof Guid) return this.value == other.getValue(); return Guid.isGuid(other) &amp;&amp; this.value == other; }; ; Guid.prototype.isEmpty = function () { return this.value === Guid.EMPTY; }; ; Guid.prototype.toString = function () { return this.value; }; ; Guid.prototype.toJSON = function () { return this.value; }; ; Guid.prototype.getValue = function () { return this.value; }; Guid.isGuid = function (value) { return value &amp;&amp; (value instanceof Guid || Guid.validator.test(value.toString())); }; ; Guid.create = function () { return new Guid([Guid.gen(2), Guid.gen(1), Guid.gen(1), Guid.gen(1), Guid.gen(3)].join(&quot;-&quot;)); }; ; Guid.raw = function () { return [Guid.gen(2), Guid.gen(1), Guid.gen(1), Guid.gen(1), Guid.gen(3)].join(&quot;-&quot;); }; ; Guid.empty = function () { return new Guid(Guid.EMPTY); }; Guid.EMPTY = &quot;00000000-0000-0000-0000-000000000000&quot;; Guid.validator = new RegExp(&quot;^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$&quot;, &quot;i&quot;); return Guid; }()); exports.Guid = Guid; × Search results Close "},"Messages.js.html":{"id":"Messages.js.html","title":"Source: Messages.js","body":" DynamicsNode Classes CRMClientDataTableFetchFilterGuidWhoAmIResponse Tutorials CommandsAndReplCompileAndTesting Global Global Source: Messages.js &quot;use strict&quot;; var WhoAmIRequest = (function () { function WhoAmIRequest() { this.__typeName = &quot;Microsoft.Crm.Sdk.Proxy,Microsoft.Crm.Sdk.Messages.WhoAmIRequest&quot;; } return WhoAmIRequest; }()); exports.WhoAmIRequest = WhoAmIRequest; /** * @class */ var WhoAmIResponse = (function () { function WhoAmIResponse() { } return WhoAmIResponse; }()); exports.WhoAmIResponse = WhoAmIResponse; var AssignRequest = (function () { function AssignRequest() { this.__typeName = &quot;Microsoft.Crm.Sdk.Proxy,Microsoft.Crm.Sdk.Messages.AssignRequest&quot;; } return AssignRequest; }()); exports.AssignRequest = AssignRequest; var AssignResponse = (function () { function AssignResponse() { } return AssignResponse; }()); exports.AssignResponse = AssignResponse; × Search results Close "},"global.html":{"id":"global.html","title":"Global","body":" DynamicsNode Classes CRMClientDataTableFetchFilterGuidWhoAmIResponse Tutorials CommandsAndReplCompileAndTesting Global Global Global Type Definitions FilterTypes Filter Type Values Type: object Properties: Name Type Description And number Indicates that all the values in the conditions must be true Or number Indicates that only one of the conditions must be true Source: Fetch.js, line 190 × Search results Close "},"classes.list.html":{"id":"classes.list.html","title":"Classes","body":" DynamicsNode Classes CRMClientDataTableFetchFilterGuidWhoAmIResponse Tutorials CommandsAndReplCompileAndTesting Global Global Classes Classes CRMClient DataTable Fetch Filter Guid WhoAmIResponse × Search results Close "},"tutorials.list.html":{"id":"tutorials.list.html","title":"Tutorials","body":" DynamicsNode Classes CRMClientDataTableFetchFilterGuidWhoAmIResponse Tutorials CommandsAndReplCompileAndTesting Global Global Tutorials Classes CRMClient DataTable Fetch Filter Guid WhoAmIResponse × Search results Close "},"index.html":{"id":"index.html","title":"Index","body":" DynamicsNode Classes CRMClientDataTableFetchFilterGuidWhoAmIResponse Tutorials CommandsAndReplCompileAndTesting Global Global Project descriptionDynamicsNode is a library built on node.js that allows you to quickly create scripts to interact with Microsoft Dynamics CRM using JavaScript. The main goal of DynamicsNode is to make you very productive when it comes to automate small tasks in Dynamics CRM. Just create a .js file, add a few lines and execute it. No more .net console applications with all the boilerplate code just for creating one record. Go productive! Github project: https://github.com/crisfervil/DynamicsNode How to use itCreate a new directory to store your scripts and cd into it $ mkdir MyScripts &amp;&amp; cd MyScriptsInstall DynamicsNode $ npm install dynamicsnodeWriting codeCreate a new js file named myscript.js and start adding code /// &lt;reference path=&quot;node_modules/dynamicsnode/dynamicsnode.d.ts&quot; /&gt; var dn = require(&quot;dynamicsnode&quot;); // update this with your CRM url and credentials if needed var crm = new dn.CRMClient(&quot;Url=http://crm.contoso.com/xrmContoso&quot;); // retrieve current user information var who = crm.whoAmI(); var myUserInfo = crm.retrieve(&quot;systemuser&quot;,who); console.log(myUserInfo.UserId); // retrieve a user named John Doe var anotherUser = crm.retrieve(&quot;systemuser&quot;,{fullname:&quot;John Doe&quot;}); console.log(anotherUser);Save the file and run the script. In order to run the script use node $ node myscriptFurther information: API How to compile and test the code: Compile and Testing Use it as a command line tool: Commands and Repl RequirementsRequires Node.js This tool is based on Edge and requires .NET Framework 4.5 to be installed. It has been tested in Windows environments only, but could potentially work in Linux too using Mono. Supported CRM versionsTested on CRM 2011, 2013 and CRM Online so far. Volunteers to run the integration tests on other versions are more than welcome :) Backlog(Ordered by priority) [ ] Improve documentation (work In progress) [ ] Add DataTable functions (work in progress) [ ] Refactor to minimize .net code [ ] Increase code coverage [ ] Add paging support in queries [ ] Add support for .net core [ ] Make it work in Mono and Linux [ ] Improve Exception Handling to show errors in CRM side [ ] Add functions to work with solutions [ ] Add integration tests for activities [ ] Add an Assert object to allow create integration tests [ ] Add examples page [ ] Add a commands to work with connections [ ] Add more commands to repl mode [ ] Add support for missing operators in condition objects [ ] Add d.ts file to Typings repository [ ] Add functions to create performance tests [ ] Add functions to allow Continuos Integration tools [ ] Add extensibility [x] Improve testeability and integration tests [x] Add import/export commands [x] Add test coverage reports [x] Upload npm package × Search results Close "},"CRMClient.html":{"id":"CRMClient.html","title":"Class: CRMClient","body":" DynamicsNode Classes CRMClientDataTableFetchFilterGuidWhoAmIResponse Tutorials CommandsAndReplCompileAndTesting Global Global Class: CRMClient CRMClient Allow access to CRM functions. Contains the functions to interact with CRM services. new CRMClient(connectionString) Default constructor Parameters: Name Type Description connectionString string Optional. A valid connection string or connection string name.The connection string can be either a valid connection string or a name of an existing connection string in the file &quot;config.json&quot; at the root path of your application.If no value is passed to the constructor, the &quot;default&quot; text will be assumed, which means that a connection string named &quot;default&quot; will be used. Source: CRMClient.js, line 13 See: https://msdn.microsoft.com/en-us/library/gg695810.aspx for further information Examples config.json file format { &quot;connectionStrings&quot;: { &quot;default&quot;:&quot;Url=http://crm.contoso.com/xrmContoso; Domain=CONTOSO; Username=jsmith; Password=passcode&quot;, &quot;connection2&quot;:&quot;Url=http://crm.contoso.com/xrmContoso&quot; } } Create a connection using a valid Connection String var crm = new CRMClient(&quot;Url=http://crm.contoso.com/xrmContoso; Domain=CONTOSO; Username=jsmith; Password=passcode&quot;); Create a connection using the connection string named &quot;connection2&quot; specified in the config.json file var crm = new CRMClient(&quot;connection2&quot;); Create a connection using the connection string named &quot;default&quot; specified in the config.json file var crm = new CRMClient(); Create a connection using the connection string named &quot;default&quot; specified in the config.json file var crm = new CRMClient(&quot;default&quot;); Methods create(entityName, attributes) Creates a record in CRM. The names in the entity or attributes are case insensitive, so all the names will be lowercased before send the operation to Crm. Parameters: Name Type Description entityName string The name of the entity which record you want to create attributes object Javascript object with the values the new record will have. Source: CRMClient.js, line 306 Returns: GUID of the record created. Type string Example Create an account named &quot;Contoso&quot; var accountid = crm.create(&quot;account&quot;,{name:&quot;contoso&quot;,description:&quot;this is a test&quot;,AccountCategoryCode:1}); console.log(accountid); createOrUpdate(entityName, attributes, matchFields) Takes a list of attributes and values, tries to find an existing record with those values in CRM, if it exists, then performs an update, otherwhise it creates it. Parameters: Name Type Description entityName string Name of the entity which record you want to update. attributes object Javascript object with the attributes you want to create or update. matchFields Array.&lt;string&gt; List of fields in the attributes parameter you want to use to know if the record exists in CRM.The attributes specified in this parameter will be used to perform a CRMClient#retrieve. Source: CRMClient.js, line 466 Examples Create an account named &quot;contoso&quot;. In this case, a retrieve of an account with name=&quot;contoso&quot; will be performed. If exists, then the name and description will be updated. If it doesn't exist, then the account will be created with the specified name and description. If theres more than one account with that name, an exception will be thrown crm.createOrUpdate(&quot;account&quot;,{name:&quot;contoso&quot;, description:&quot;Account Updated&quot;},[&quot;name&quot;]); Searches for an account named &quot;contoso&quot; owned by me. If exists, it updates it, otherwhise it creates a new one. var me = crm.whoAmI().UserId; crm.createOrUpdate(&quot;account&quot;,{name:&quot;contoso&quot;, description:&quot;Account Updated&quot;, ownerid:me},[&quot;name&quot;,&quot;ownerid&quot;]); delete(entityName, idsOrConditions) Deletes one on more records in CRM, and returns the number of records affected. Parameters: Name Type Description entityName string Name of the entity which record you want to delete idsOrConditions string | Guid | Array.&lt;string&gt; | object Can be either a Guid, a string, an array or a conditions object.If it is Guid will delete the record with the specified id.If it is a string, must be a Guid value, and again, will delete the records matching the specified id.If the parameter is an array, each element in it must be either a string or a Guid, and in each case, the records deleted will be the ones specified by these Guids.If it is a condition object, first, all the matching records will be retrieved, and then deleted.Learn how to write condition objects: Fetch#setFilter Source: CRMClient.js, line 334 Returns: Number of records deleted Type number Examples Delete an account with a known Guid var affectedRecords = crm.delete(&quot;account&quot;,&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;); Delete an account with a known Guid. A validation of the Guid format will be performed before calling to the method. var affectedRecords = crm.delete(&quot;account&quot;,new Guid(&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;)); Delete several account records at once var affectedRecords = crm.delete(&quot;account&quot;,[&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;,&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;); Delete all existing accounts named &quot;contoso&quot; var affectedRecords = crm.delete(&quot;account&quot;,{name:&quot;contoso&quot;}); &lt;private&gt; getBridge(fakeBridge) Gets the bridge object between node and .net Parameters: Name Type Description fakeBridge boolean indicates if a fake bridge whants to be retrieved Source: CRMClient.js, line 51 Returns: a .net bridge that allows node to interact with .net retrieve(entityName, idOrConditions, attributes) Retrieves one single record from CRM. Parameters: Name Type Description entityName string Name of the entity to be retrieved. The name is case insensitive, so all values are lowercased before being sent to CRM. idOrConditions string | Guid | object Either a string with the GUID if the record to be retrieved, a Guid object with the same value, or a conditions object that returns only one record.Learn how to write condition objects: Fetch#setFilter attributes string | Array.&lt;string&gt; | boolean Optional. Either an attribute name, an array of attributes, or a true value indicating that all attributes must be retrieved. The default value is true. An * value has the same effect Source: CRMClient.js, line 131 Returns: A javascript object containing the values of the record. If no data found, then a null object is returned. Examples Return all the columns for the specified account id var account = crm.retrieve(&quot;account&quot;,&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;); console.log(account); Return all the columns for the specified account id var account = crm.retrieve(&quot;account&quot;,&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;,&quot;*&quot;); console.log(account); Return all the columns for the specified account id var account = crm.retrieve(&quot;account&quot;,&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;,true); console.log(account); You can use the Guid class to specify the id parameter. This allows to perform a GUID format validation before calling the method. var Guid = require(&quot;dynamicsnode&quot;).Guid; var account = crm.retrieve(&quot;account&quot;,new Guid(&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;)); console.log(account); Get the accountid,name,ownerid,createdon columns for the given account id var account = crm.retrieve(&quot;account&quot;,&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;,[&quot;accountid&quot;,&quot;name&quot;,&quot;ownerid&quot;,&quot;createdon&quot;]); console.log(account); Get the name of the specified account var account = crm.retrieve(&quot;account&quot;,&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;,&quot;name&quot;); console.log(account.name); Accessing information about a related record var account = crm.retrieve(&quot;account&quot;,&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;,&quot;ownerid&quot;); console.log(account.ownerid); // outputs the GUID value console.log(account.ownerid_type); // outputs systemuser console.log(account.ownerid_name); // outputs John Doe Returns an account using a condition object. If there are more than one account named &quot;Acme&quot; then an exception will be thrown var account = crm.retrieve(&quot;account&quot;,{name:&quot;Acme&quot;}); console.log(account.name); retrieveAll(entityName) It is a simpified way of retrieving all the existing records of an entity. Is equivalent to call the CRMClient#retrieveMultiple method not specifying the conditions or attributes method Parameters: Name Type Description entityName string Name of the entity which records you want to retrieve. Source: CRMClient.js, line 293 Returns: DataTable object with the records found. Type DataTable Example Retrieve all existing account records var accounts = crm.retrieveAll(&quot;account&quot;); retrieveMultiple(entityNameOrFetchXml, conditions, attributes) Retrieves one or more records of the specified entity that fulfill the specified conditions. Parameters: Name Type Description entityNameOrFetchXml string Name of the entity or Fetch Xml query to specify the records to be retrieved. More info: https://msdn.microsoft.com/en-us/library/gg328332.aspx conditions object Optional. In case you don't want to write a FetchXml to specify the records to retrieve, you can use a conditions object to specify the criteria to retrieve records. If you omit this parameter, all the existing records of the specified entity will be retrieved; omitting this parameter is equivalent to write a FetchXml without any filter conditions.Learn how to write condition objects: Fetch#setFilter attributes string | Array.&lt;string&gt; | boolean Optional. Either an attribute name, an array of attributes, or a true value indicating that all attributes must be retrieved. The default value is true. An * value has the same effect Source: CRMClient.js, line 242 See: Build queries with FetchXML: https://msdn.microsoft.com/en-us/library/gg328332.aspx Returns: DataTable object with the records found. Type DataTable Examples Retrieves all the records of the account entity. Only the accountid column will be retrieved (the id column is always returned in all Crm queries) var accounts = crm.retrieveMultiple(&quot;&lt;fetch&gt;&lt;entity name='account'&gt;&lt;/entity&gt;&lt;/fetch&gt;&quot;); Retrieves all the records of the account entity. Includes also all the columns of the entity. var accounts = crm.retrieveMultiple(&quot;account&quot;); Retrieves all the records of the account entity where the account name is equals to &quot;contoso&quot;. Returns all the columns of the entity. var accounts = crm.retrieveMultiple(&quot;account&quot;,{name:&quot;contoso&quot;}); Retrieves all the records of the account entity where the account name is equals to &quot;contoso&quot;, but only the specified columns are included in the query. var accounts = crm.retrieveMultiple(&quot;account&quot;,{name:&quot;contoso&quot;},[&quot;accountid&quot;,&quot;name&quot;,&quot;ownerid&quot;,&quot;createdon&quot;]); Retrieves all the records of the account entity where the account name is equals to &quot;contoso&quot; or &quot;acme&quot;. Returns all the columns of the entity. var accounts = crm.retrieveMultiple(&quot;account&quot;,{name:[&quot;contoso&quot;,&quot;acme&quot;]}); testConnection() Tests the active connection. Throws an exception if there's any error.The method performs a WhoAmIRequest. Source: CRMClient.js, line 116 See: CRMClient#whoAmI update(entityName, attributes, conditions) Updates one or more records that meet the specified conditions and returns the number of updated records. Parameters: Name Type Description entityName string The name of the entity which record you want to update. attributes object Javascript object with the values the new record will have. conditions opbject Optional. Javascript condition object with the filter values that is going to be used to know which records are going to be updated.If you omit this parameter, then you have to provide the record GUID in the attributes parameter.Learn how to write condition objects: Fetch#setFilter Source: CRMClient.js, line 398 Returns: Number of modified records Type number Examples Updates all the accounts which name is contoso, and set the attribute value to &quot;contoso-updated&quot; var affectedRecords = crm.update(&quot;account&quot;,{name:&quot;contoso-updated&quot;},{name:&quot;contoso&quot;}) In this example, only the account with the specified account id will be updated. If the specified record id exists, then affectedRecords will be equals to 1. var affectedRecords = crm.update(&quot;account&quot;,{accountid:&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;,name:&quot;contoso-updated&quot;}) whoAmI() Returns information about the current user. Useful for testing the active connection. Source: CRMClient.js, line 101 Returns: a WhoAmIResponse object with the information about the authenticated user in CRM. Example Returns information about the current user var who = crm.whoAmI(); console.log(who.BusinessUnitId); // prints 6fefeb79-5447-e511-a5db-0050568a69e2 console.log(who.OrganizationId); // prints 2b476bd1-aaed-43ee-b386-eee0f1b87207 console.log(who.UserId); // prints 9ba35c25-b892-4f8a-b124-3920d9873af4 × Search results Close "},"DataTable.html":{"id":"DataTable.html","title":"Class: DataTable","body":" DynamicsNode Classes CRMClientDataTableFetchFilterGuidWhoAmIResponse Tutorials CommandsAndReplCompileAndTesting Global Global Class: DataTable DataTable Represents a DataTable object. Contains methods to save and load the row values from a file. new DataTable() Default constructor Source: DataTable.js, line 8 × Search results Close "},"Fetch.html":{"id":"Fetch.html","title":"Class: Fetch","body":" DynamicsNode Classes CRMClientDataTableFetchFilterGuidWhoAmIResponse Tutorials CommandsAndReplCompileAndTesting Global Global Class: Fetch Fetch Provides properties and methods to create FetchXml queries new Fetch(entityName, attr, filterConditions) Default Constructor Parameters: Name Type Description entityName string Optional. Name of the entity which the query is for attr string | boolean | Array.&lt;string&gt; Optional. Either a column name, or a list of column names, or a boolean value indicating that all the attribute values want to be retrieved. The default value is null, and means that only the primary attribute will be retrieved. filterConditions object Optional. Object that describes conditions in an JSON notation. More Info: Fetch#setFilter Source: Fetch.js, line 4 Examples Create an empty FetchXml var fetch = new Fetch(); console.log(fetch.toString()); // outputs: &lt;fetch&gt;&lt;entity&gt;&lt;/entity&gt;&lt;/fetch&gt; Create a Fetch query for the &quot;account&quot;&quot; entity, with 3 attributes and one filter var fetch = new Fetch(&quot;account&quot;,[&quot;description&quot;,&quot;createdon&quot;,&quot;ownerid&quot;],{name:&quot;acme&quot;}); Create a Fetch query for the &quot;account&quot;&quot; entity, with all attributes and one filter var fetch = new Fetch(&quot;account&quot;,true,{name:&quot;acme&quot;}); Methods setFilter(filterCondition) Sets the filter criteria of the current FetchXml with the specified values. The specified value can be eiher a Filter object or a conditions object. A conditions object is a Javascript object where every property represents a condition. If the object contains a property, and that property contains a simple value, like an string or a number, that means property equals to value. If you need to specify another operator, then you have to use the form: {attribute:{$operator:value}} If the value is an array, then the $in operator is used. If the value is a null value, then the nulloperator is applied. For example: {name:null} will retrieve all the records where the name is null. Parameters: Name Type Description filterCondition Filter | object A Filter object or a Conditions specified in JSON notation. Source: Fetch.js, line 53 See: Build queries with FetchXML: https://msdn.microsoft.com/en-us/library/gg328332.aspx Examples When the simple syntax is used {name:value} then the $eq operator is used. The following filter retrieves all records where the attribute name is equals to &quot;myAccount&quot; var cond = {name:&quot;myAccount&quot;}; The following retrieves all records where the attribute name is equals to &quot;myAccount&quot; AND the createdon date is equals to the system date var cond = {name:&quot;myAccount&quot;, createdon:new Date()} If you need to specify additional operators, then use a subobject with the operator name. The following retrieves all records where the attribute name begins with &quot;contoso%&quot; and the attribute createdon is bigger than the current date var cond = {name:{$like:&quot;contoso%&quot;}, createdon:{$bt:new Date()}} Currently supported operators: $eq, $neq, $gt, $ge, $le, $lt, $like, $notlLike, $in, $notIn, $between, $notBetween If the value is an array, then the in operator is applied. The wollowing means: where name is one of contoso, acme or cycleworks var cond = {name:[&quot;contoso&quot;, &quot;acme&quot;, &quot;cycleworks&quot;]}; To specify the null operator, use a null value next to the attribute name. The following will retrieve all the records where the name is null. var cond = {name:null}; × Search results Close "},"Filter.html":{"id":"Filter.html","title":"Class: Filter","body":" DynamicsNode Classes CRMClientDataTableFetchFilterGuidWhoAmIResponse Tutorials CommandsAndReplCompileAndTesting Global Global Class: Filter Filter Describes a Filter in a Fetch query. new Filter() Default Constructor Source: Fetch.js, line 202 Members conditions :Array.&lt;Condition&gt; Contains the conditions of this filter Type: Array.&lt;Condition&gt; Source: Fetch.js, line 207 filterType :FilterTypes Indicates if the filter is an And or Or filter Type: FilterTypes Source: Fetch.js, line 208 × Search results Close "},"Guid.html":{"id":"Guid.html","title":"Class: Guid","body":" DynamicsNode Classes CRMClientDataTableFetchFilterGuidWhoAmIResponse Tutorials CommandsAndReplCompileAndTesting Global Global Class: Guid Guid Provides methos to generate an validate GUID values and to convert them from and to a String. new Guid(string) Default constructor Parameters: Name Type Description string string value representing a Guid Value Source: Guid.js, line 3 × Search results Close "},"WhoAmIResponse.html":{"id":"WhoAmIResponse.html","title":"Class: WhoAmIResponse","body":" DynamicsNode Classes CRMClientDataTableFetchFilterGuidWhoAmIResponse Tutorials CommandsAndReplCompileAndTesting Global Global Class: WhoAmIResponse WhoAmIResponse new WhoAmIResponse() Source: Messages.js, line 12 × Search results Close "},"tutorial-CommandsAndRepl.html":{"id":"tutorial-CommandsAndRepl.html","title":"Tutorial: CommandsAndRepl","body":" DynamicsNode Classes CRMClientDataTableFetchFilterGuidWhoAmIResponse Tutorials CommandsAndReplCompileAndTesting Global Global CommandsAndRepl CommandsCommands are a way to use Dynamics Node from command line. In order to use those commands, you have to install DynamicsNode in global mode. To install DynamicsNode in global mode use the following command. $ npm install -g dynamicsnodeExportExports the data of the specified entity to the specified file using the specified connection. Usage: $ dynamicsnode export -e [entityName] -f [file] -c [connection]This will export all the existing accounts to the accounts.xml file. You can specify either an xml or a json file. CRMOnline is the connection string or the connection name to use. In order to reference connections using a name, create a file config.json at the root of your scripts folder. The config.json must have the following format: { &quot;connectionStrings&quot;: { &quot;default&quot;:&quot;Url=https://contoso.crm4.dynamics.com&quot;, &quot;CRMOnline&quot;:&quot;Url=https://contoso.crm4.dynamics.com; Username=admin@contoso.onmicrosoft.com; Password=YourPassword;&quot; } }Each name inside connectionStrings is a name you can use in your export command. Import$ dynamicsnode import -f [fileName] -c [connection]This command imports the contents of the specified file into CRM. As in the export command, you can specify any connection name in the config.json file. The specified file can be an .xml or .json file. Each one has a very specific format. The easiest way to review this format is generate it through the export command. Repl integration$ dynamicsnode replThis command initiates Dynamics Node in repl mode. This means, that you can interact with CRM using the existing API and evaluating the code as you type it. × Search results Close "},"tutorial-CompileAndTesting.html":{"id":"tutorial-CompileAndTesting.html","title":"Tutorial: CompileAndTesting","body":" DynamicsNode Classes CRMClientDataTableFetchFilterGuidWhoAmIResponse Tutorials CommandsAndReplCompileAndTesting Global Global CompileAndTesting How to compile the codePrerequisitesIn order to build the TypeScript compiler, ensure that you have Git and Node.js installed. StepsFirst, get the latest version of the code from Github, either using the clone button from the web, or using the command line. $ git clone https://github.com/crisfervil/DynamicsNode.gitThen, cd into the cloned directory $ cd DynamicsNodeInstall dependencies using npm $ npm installRun the build script $ npm run buildHow to run testsUse the default npm command for testing. $ npm testDebugIn order to see debug information in console, type following command: set DEBUG=dynamicsnodeYou should see debug information like this: dynamicsnode Exporting account to accounts.xml +0ms dynamicsnode Getting metadata... +0ms dynamicsnode Getting data... +1s dynamicsnode Saving... +531ms dynamicsnode done! +32msIntegration TestsIn order to run the integration tests, first clone and compile the code as described above. Then, you need create a config.json file in the root of DynamicsNode folder. The config.json must have the following format: { &quot;connectionStrings&quot;: { &quot;IntegrationTestsOnline&quot;:&quot;Url=https://contoso.crm4.dynamics.com; Username=admin@contoso.onmicrosoft.com; Password=YourPassword;&quot; } }You need to create a connection string named &quot;IntegrationTestsXXXX&quot; where XXXX is whatever name you want to use to indentify your connection. After doing that, just re-run tests script with npm. $ npm testYou should see something like this: c:\\GitHub\\DynamicsNode&gt;npm test &gt; dynamicsnode@0.0.4 test c:\\GitHub\\DynamicsNode &gt; mocha --recursive CRMClient √ Throws an exception with an invalid connection (169ms) √ Tells who I am (148ms) √ Creates a record (153ms) √ Deletes a record (147ms) √ Updates a record (137ms) √ Associates two records (169ms) √ Disassociates two records (163ms) √ Gets entity metadata (153ms) DataTable √ Initializes from an existing Array √ Loads and read JSON data √ Loads and reads XML data Fetch √ Serializes a simple Fetch √ Serializes a simple Fetch with conditions √ Serializes a complex Fetch Guid √ Creates an instance of non empty Guid √ Creates an instance of empty Guid √ Creates an instance from a string √ Validates Guid format on creation √ Generates new Guids √ Compares two different Guids √ Compares two equal Guids √ Compares a Guid value with a string Integration tests: IntegrationTestsOnline √ Throws an exception with an invalid connection (169ms) √ Creates an account (937ms) √ Updates an account (588ms) √ Updates an account using a criteria (1740ms) √ Knows Who I am (68ms) √ Performs a simple retrieve (139ms) √ Performs a retrieve that doesnt returns any records (134ms) √ Performs a retrieve that doesnt returns any records using a GUID (100ms) √ Performs a retrieve with specific columns (139ms) √ Performs a retrieve with all columns (131ms) √ Performs a &quot;retrieve all&quot; of an entity (134ms) √ Performs a simple retrieve multiple (185ms) √ Performs a retrieve all (154ms) √ Associates and Disassociates a lead and an contact (434ms) √ Associates and Disassociates a lead and an contact using a DataTable (440ms) √ Gets entity metadata - Export and import users to a File 38 passing (7s) 1 pending × Search results Close "}}
    </script>

    <script type="text/javascript">
        $(document).ready(function() {
            Searcher.init();
        });

        $(window).on("message", function(msg) {
            var msgData = msg.originalEvent.data;

            if (msgData.msgid != "docstrap.quicksearch.start") {
                return;
            }

            var results = Searcher.search(msgData.searchTerms);

            window.parent.postMessage({"results": results, "msgid": "docstrap.quicksearch.done"}, "*");
        });
    </script>
</body>
</html>
