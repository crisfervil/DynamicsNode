<html>
<head>
</head>
<body style="background: transparent;">
    <script src="scripts/docstrap.lib.js"></script>
    <script src="scripts/lunr.min.js"></script>
    <script src="scripts/fulltext-search.js"></script>

    <script type="text/x-docstrap-searchdb">
    {"CRMClient.js.html":{"id":"CRMClient.js.html","title":"Source: CRMClient.js","body":" DynamicsNode Classes CRMClientDataTableDataTableJsonSerializerDataTableSerializerDataTableXlsSerializerDataTableXmlSerializerFetchFilterGuid Tutorials CommandsAndReplCompileAndTesting Global Global Source: CRMClient.js &quot;use strict&quot;; Object.defineProperty(exports, &quot;__esModule&quot;, { value: true }); var DataTable_1 = require(&quot;./DataTable&quot;); var Guid_1 = require(&quot;./Guid&quot;); var Fetch_1 = require(&quot;./Fetch&quot;); var Messages_1 = require(&quot;./Messages&quot;); var CRMDataTypes_1 = require(&quot;./CRMDataTypes&quot;); var ImportExportUtil_1 = require(&quot;./ImportExportUtil&quot;); var StateUtil_1 = require(&quot;./StateUtil&quot;); var MetadataUtil_1 = require(&quot;./MetadataUtil&quot;); var path = require(&quot;path&quot;); var edge = require(&quot;edge&quot;); var debug = require(&quot;debug&quot;)(&quot;dynamicsnode&quot;); var debugQueries = require(&quot;debug&quot;)(&quot;dynamicsnode:queries&quot;); var CRMClient = (function () { /** * Default constructor * @classdesc Allow access to CRM functions. Contains the functions to interact with CRM services. * @class CRMClient * @param {string} connectionString Optional. A valid connection string or connection string name. * The connection string can be either a valid connection string or a name of an existing connection string in the file &quot;config.json&quot; at the root path of your application. * If no value is passed to the constructor, the &quot;default&quot; text will be assumed, which means that a connection string named &quot;default&quot; will be used. * @see {@link https://msdn.microsoft.com/en-ie/library/mt608573.aspx} for further information * * @example &lt;caption&gt;config.json file format&lt;/caption&gt; * { * &quot;connectionStrings&quot;: * { * &quot;default&quot;:&quot;AuthType=Office365; Url=http://crm.contoso.com/xrmContoso; Domain=CONTOSO; Username=jsmith; Password=passcode&quot;, * &quot;connection2&quot;:&quot;AuthType=AD; Url=http://crm.contoso.com/xrmContoso&quot; * } * } * @example &lt;caption&gt;Create a connection using a valid Connection String&lt;/caption&gt; * var crm = new CRMClient(&quot;AuthType=Office365; Url=http://crm.contoso.com/xrmContoso; Domain=CONTOSO; Username=jsmith; Password=passcode&quot;); * @example &lt;caption&gt;Create a connection using the connection string named &quot;connection2&quot; specified in the config.json file&lt;/caption&gt; * var crm = new CRMClient(&quot;connection2&quot;); * @example &lt;caption&gt;Create a connection using the connection string named &quot;default&quot; specified in the config.json file&lt;/caption&gt; * var crm = new CRMClient(); * @example &lt;caption&gt;Create a connection using the connection string named &quot;default&quot; specified in the config.json file&lt;/caption&gt; * var crm = new CRMClient(&quot;default&quot;); */ function CRMClient(connectionString, fakeBridge) { if (connectionString === void 0) { connectionString = &quot;default&quot;; } if (fakeBridge === void 0) { fakeBridge = false; } this.connectionString = connectionString; var config = this.tryGetModule(path.join(process.cwd(), &quot;config.json&quot;)); if (config &amp;&amp; config.connectionStrings &amp;&amp; config.connectionStrings[connectionString]) { this.connectionString = config.connectionStrings[connectionString]; } this._crmBridge = this.getBridge(fakeBridge); this.testConnection(); } /** * Gets the bridge object between node and .net * @private * @method CRMClient#getBridge * @param fakeBridge {boolean} indicates if a fake bridge whants to be retrieved * @returns a .net bridge that allows node to interact with .net */ CRMClient.prototype.getBridge = function (fakeBridge) { var assemblyFile = path.join(__dirname, &quot;bin/DynamicsNode.dll&quot;); var refs = [path.join(__dirname, &quot;bin/Microsoft.Crm.Sdk.Proxy.dll&quot;), path.join(__dirname, &quot;bin/Microsoft.Xrm.Tooling.Connector.dll&quot;), path.join(__dirname, &quot;bin/Microsoft.Xrm.Sdk.dll&quot;), &quot;System.Runtime.Serialization.dll&quot;, &quot;System.ServiceModel.dll&quot;, path.join(__dirname, &quot;bin/Microsoft.IdentityModel.Clients.ActiveDirectory.dll&quot;) ]; var createBridge = edge.func({ assemblyFile: assemblyFile, references: refs }); var bridge = createBridge({ connectionString: this.connectionString, useFake: fakeBridge }, true); return bridge; }; CRMClient.prototype.tryGetModule = function (moduleId) { var result = null; try { result = require(moduleId); } catch (e) { } return result; }; CRMClient.prototype.convert = function (propertiesArray) { var converted = null; if (propertiesArray) { converted = {}; for (var i = 0; i &lt; propertiesArray.length; i++) { var propValue = propertiesArray[i]; if (propValue[1] instanceof Array) { var convertedValues = []; for (var j = 0; i &lt; propValue[1].length; i++) { var arrayItem = propValue[1][j]; convertedValues.push(this.convert(arrayItem)); } converted[propValue[0]] = convertedValues; } else { converted[propValue[0]] = propValue[1]; } } } return converted; }; /** * Returns information about the current user. Useful for testing the active connection. * @returns a {@link WhoAmIResponse} object with the information about the authenticated user in CRM. * @method CRMClient#whoAmI * @example &lt;caption&gt;Returns information about the current user&lt;/caption&gt; * var who = crm.whoAmI(); * console.log(who.BusinessUnitId); // prints 6fefeb79-5447-e511-a5db-0050568a69e2 * console.log(who.OrganizationId); // prints 2b476bd1-aaed-43ee-b386-eee0f1b87207 * console.log(who.UserId); // prints 9ba35c25-b892-4f8a-b124-3920d9873af4 */ CRMClient.prototype.whoAmI = function () { var request = new Messages_1.WhoAmIRequest(); var response = this.Execute(request); return response; }; /** * Tests the active connection. Throws an exception if there's any error. * The method performs a {@link WhoAmIRequest}. * @method CRMClient#testConnection * @see CRMClient#whoAmI */ CRMClient.prototype.testConnection = function () { try { this.whoAmI(); // Performs a who am i request } catch (e) { var error = new Error(); throw new Error(&quot;Error trying to connect to server\\n&quot; + JSON.stringify(e)); } }; /** * Retrieves one single record from CRM. * @method CRMClient#retrieve * @param entityName {string} Name of the entity to be retrieved. The name is case insensitive, so all values are lowercased before being sent to CRM. * @param idOrConditions {string|Guid|object} Either a string with the GUID if the record to be retrieved, a {@link Guid} object with the same value, or a conditions object that returns only one record. * Learn how to write condition objects: {@link Fetch#setFilter} * @param attributes {string|string[]|boolean} Optional. Either an attribute name, an array of attributes, or a true value indicating that all attributes must be retrieved. The default value is true. An ***** value has the same effect * * @returns A javascript object containing the values of the record. If no data found, then a null object is returned. * * @example &lt;caption&gt;Return all the columns for the specified account id&lt;/caption&gt; * var account = crm.retrieve(&quot;account&quot;,&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;); * console.log(account); * @example &lt;caption&gt;Return all the columns for the specified account id&lt;/caption&gt; * var account = crm.retrieve(&quot;account&quot;,&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;,&quot;*&quot;); * console.log(account); * @example &lt;caption&gt;Return all the columns for the specified account id&lt;/caption&gt; * var account = crm.retrieve(&quot;account&quot;,&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;,true); * console.log(account); * @example &lt;caption&gt;You can use the Guid class to specify the id parameter. This allows to perform a GUID format validation before calling the method.&lt;/caption&gt; * var Guid = require(&quot;dynamicsnode&quot;).Guid; * var account = crm.retrieve(&quot;account&quot;,new Guid(&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;)); * console.log(account); * @example &lt;caption&gt;Get the accountid,name,ownerid,createdon columns for the given account id&lt;/caption&gt; * var account = crm.retrieve(&quot;account&quot;,&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;,[&quot;accountid&quot;,&quot;name&quot;,&quot;ownerid&quot;,&quot;createdon&quot;]); * console.log(account); * @example &lt;caption&gt;Get the name of the specified account&lt;/caption&gt; * var account = crm.retrieve(&quot;account&quot;,&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;,&quot;name&quot;); * console.log(account.name); * @example &lt;caption&gt;Accessing information about a related record&lt;/caption&gt; * var account = crm.retrieve(&quot;account&quot;,&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;,&quot;ownerid&quot;); * console.log(account.ownerid); // outputs the GUID value * console.log(account.ownerid_type); // outputs systemuser * console.log(account.ownerid_name); // outputs John Doe * @example &lt;caption&gt;Returns an account using a condition object. If there are more than one account named &quot;Acme&quot; then an exception will be thrown&lt;/caption&gt; * var account = crm.retrieve(&quot;account&quot;,{name:&quot;Acme&quot;}); * console.log(account.name); */ CRMClient.prototype.retrieve = function (entityName, idOrConditions, pColumns) { var idValue; var result; var columns; if (!entityName) throw new Error(&quot;Entity name not specified&quot;); if (!idOrConditions) throw new Error(&quot;Id or Conditions not specified&quot;); entityName = entityName.toLocaleLowerCase(); // normalize casing // validate columns if (pColumns === undefined) { columns = true; // default value } else { columns = pColumns; if (typeof pColumns == &quot;string&quot;) { columns = [pColumns]; } if (Array.isArray(columns)) { for (var i = 0; i &lt; columns.length; i++) { columns[i] = columns[i].toLocaleLowerCase(); // normalize casing; } } } if (idOrConditions instanceof Guid_1.Guid) { idValue = idOrConditions.getValue(); } else if (typeof idOrConditions === &quot;string&quot; || idOrConditions instanceof String) { idValue = idOrConditions; if (!Guid_1.Guid.isGuid(idValue)) throw new Error(&quot;Invalid GUID value&quot;); } else if (typeof idOrConditions === &quot;object&quot;) { // Assume a conditions objet was passed // Get the records that meet the specified criteria var idField = this.getIdField(entityName); var foundRecords = this.retrieveMultiple(entityName, idOrConditions, idField); if (foundRecords.rows !== null) { if (foundRecords.rows.length &gt; 1) throw new Error(&quot;Too many records found matching the specified criteria&quot;); if (foundRecords.rows.length &gt; 0) { // TODO: Refactor to avoid querying CRM twice idValue = foundRecords.rows[0][idField]; } } } else { throw new Error(&quot;invalid idOrConditions type value&quot;); } if (idValue) { var params = { entityName: entityName, id: idValue, columns: columns }; var retrieveResult; try { retrieveResult = this._crmBridge.Retrieve(params, true); } catch (ex) { var rethrow = false; if (ex.Detail &amp;&amp; ex.Detail.InnerFault &amp;&amp; ex.Detail.InnerFault.Message) { // Record with specified Id doesn't exists var msg = entityName + &quot; With Id = &quot; + idValue.toLowerCase().replace(&quot;{&quot;, &quot;&quot;).replace(&quot;}&quot;, &quot;&quot;) + &quot; Does Not Exist&quot;; if (ex.Detail.InnerFault.Message != msg) rethrow = true; } if (rethrow) throw ex; } // convert the result to a js object if (retrieveResult != null) { result = this.convert(retrieveResult); } } return result; }; /** * Retrieves one or more records of the specified entity that fulfill the specified conditions. * @method CRMClient#retrieveMultiple * * @param entityNameOrFetchXml {string} Name of the entity or Fetch Xml query to specify the records to be retrieved. More info: {@link https://msdn.microsoft.com/en-us/library/gg328332.aspx} * @param conditions {object} Optional. In case you don't want to write a FetchXml to specify the records to retrieve, you can use a conditions object to specify the criteria to retrieve records. If you omit this parameter, all the existing records of the specified entity will be retrieved; omitting this parameter is equivalent to write a FetchXml without any filter conditions. * Learn how to write condition objects: {@link Fetch#setFilter} * @param attributes {string|string[]|boolean} Optional. Either an attribute name, an array of attributes, or a true value indicating that all attributes must be retrieved. The default value is true. An ***** value has the same effect * @returns {DataTable} {@link DataTable} object with the records found. * * @see Build queries with FetchXML: {@link https://msdn.microsoft.com/en-us/library/gg328332.aspx} * * @example &lt;caption&gt;Retrieves all the records of the account entity. Only the accountid column will be retrieved (the id column is always returned in all Crm queries)&lt;/caption&gt; * var accounts = crm.retrieveMultiple(&quot;&lt;fetch&gt;&lt;entity name='account'&gt;&lt;/entity&gt;&lt;/fetch&gt;&quot;); * @example &lt;caption&gt;Retrieves all the records of the account entity. Includes also all the columns of the entity.&lt;/caption&gt; * var accounts = crm.retrieveMultiple(&quot;account&quot;); * @example &lt;caption&gt;Retrieves all the records of the account entity where the account name is equals to &quot;contoso&quot;. Returns all the columns of the entity.&lt;/caption&gt; * var accounts = crm.retrieveMultiple(&quot;account&quot;,{name:&quot;contoso&quot;}); * @example &lt;caption&gt;Retrieves all the records of the account entity where the account name is equals to &quot;contoso&quot;, but only the specified columns are included in the query.&lt;/caption&gt; * var accounts = crm.retrieveMultiple(&quot;account&quot;,{name:&quot;contoso&quot;},[&quot;accountid&quot;,&quot;name&quot;,&quot;ownerid&quot;,&quot;createdon&quot;]); * @example &lt;caption&gt;Retrieves all the records of the account entity where the account name is equals to &quot;contoso&quot; or &quot;acme&quot;. Returns all the columns of the entity.&lt;/caption&gt; * var accounts = crm.retrieveMultiple(&quot;account&quot;,{name:[&quot;contoso&quot;,&quot;acme&quot;]}); * */ CRMClient.prototype.retrieveMultiple = function (entityNameOrFetchXml, conditions, attributes) { var result = new Array(); var fetchXml; if (!(conditions || attributes)) { // No conditions or attributes were specified, means a FetchXml value is expected. // TODO: Improve this. could use a regular expression to distinguish between an xml and an entity name? fetchXml = entityNameOrFetchXml; } else { var fetch = new Fetch_1.Fetch(entityNameOrFetchXml); if (conditions) { fetch.setFilter(conditions); } if (attributes) { fetch.setAttributes(attributes); } fetchXml = fetch.toString(); debugQueries(fetchXml); } var retrieveResult = this._crmBridge.RetrieveMultiple(fetchXml, true); for (var i = 0; i &lt; retrieveResult.length; i++) { var record = retrieveResult[i]; var convertedRecod = this.convert(record); result.push(convertedRecod); } var dt = new DataTable_1.DataTable(entityNameOrFetchXml, result); return dt; }; /** It is a simpified way of retrieving all the existing records of an entity. Is equivalent to call the {@link CRMClient#retrieveMultiple} method not specifying the conditions or attributes method * @method CRMClient#retrieveAll * @param entityName {string} Name of the entity which records you want to retrieve. * @returns {DataTable} {@link DataTable} object with the records found. * @example &lt;caption&gt;Retrieve all existing account records&lt;/caption&gt; * var accounts = crm.retrieveAll(&quot;account&quot;); */ CRMClient.prototype.retrieveAll = function (entityName) { var fetch = new Fetch_1.Fetch(entityName, &quot;*&quot;); var fetchXml = fetch.toString(); var result = this.retrieveMultiple(fetchXml); return result; }; /** * Creates a record in CRM. The names in the entity or attributes are case insensitive, so all the names will be lowercased before * send the operation to Crm. * @method CRMClient#create * @param entityName {string} The name of the entity which record you want to create * @param attributes {object} Javascript object with the values the new record will have. * * @returns {string} GUID of the record created. * * @example &lt;caption&gt;Create an account named &quot;Contoso&quot;&lt;/caption&gt; * var accountid = crm.create(&quot;account&quot;,{name:&quot;contoso&quot;,description:&quot;this is a test&quot;,AccountCategoryCode:1}); * console.log(accountid); * @example &lt;caption&gt;Create an email with activity parties&lt;/caption&gt; * var contact1Id = &quot;{6633f95b-c146-45d4-ae99-6bd84f9bf7bc}&quot; * var contact2Id = &quot;{6633f95b-c146-45d4-ae99-6bd84f9bf7bc}&quot; * var userId = &quot;{6633f95b-c146-45d4-ae99-6bd84f9bf7bc}&quot; * var email = { * To : [{id:contact1Id,type:&quot;contact&quot;},{id:contact2Id,type:&quot;contact&quot;}], * From : [{id:userId,type:&quot;systemuser&quot;}], * Subject : &quot;Test Email&quot;, * Description : &quot;Test Email&quot;, * DirectionCode : true * }; * var emailId = crm.create(&quot;email&quot;,email); */ /** * Creates records in CRM using the rows defined in the DataTable. * The id attribute of every created record will be updated with the generated CRM GUID. * You need to set the name of the table with the entity name that you want to create. * @method CRMClient#create * @param data {DataTable} DataTable with the data to be created in CRM. * * @example &lt;caption&gt;Create a set of accounts using an excel file&lt;/caption&gt; * var accountsToLoad = DataTable.load(&quot;AccountsToLoad.xlsx&quot;); * crm.create(accountsToLoad); * console.log(accountsToLoad.rows[0].accountid); // This will output the GUID of the created record */ CRMClient.prototype.create = function (entityNameOrTable, attributes) { var retVal = null; if (entityNameOrTable instanceof DataTable_1.DataTable) { if (entityNameOrTable.name == null) throw new Error(&quot;Table name not specified&quot;); debug(&quot;Preparing to create &quot; + entityNameOrTable.rows.length + &quot; records from a DataTable. Entity &quot; + entityNameOrTable.name + &quot;...&quot;); var primaryAttribute = this.getIdField(entityNameOrTable.name); debug(&quot;Primary Attribute:&quot; + primaryAttribute); for (var i = 0; i &lt; entityNameOrTable.rows.length; i++) { debug(i + &quot; of &quot; + entityNameOrTable.rows.length + &quot;...&quot;); var row = entityNameOrTable.rows[i]; var recordId = this.createInternal(entityNameOrTable.name, row); // update the record id in the table row[primaryAttribute] = recordId; } } else { if (attributes === undefined) throw new Error(&quot;The attributes parameter is required&quot;); debug(&quot;Preparing to create a &quot; + entityNameOrTable + &quot; record...&quot;); retVal = this.createInternal(entityNameOrTable, attributes); } return retVal; }; CRMClient.prototype.createInternal = function (entityName, attributes) { var entity = this.ConvertToEntity(entityName, attributes); var createdGuid = this._crmBridge.Create(entity, true); return createdGuid; }; CRMClient.prototype.ConvertToEntity = function (entityName, attributes) { // perform some validations if (!entityName) throw new Error(&quot;Entity name not specified&quot;); if (!attributes) throw new Error(&quot;Attributes not specified&quot;); entityName = entityName.toLocaleLowerCase(); // normalize casing var entityMetadata = this.getEntityMetadata(entityName); debug(&quot;Converting attributes to CRM Entity type...&quot;); var entity = new CRMDataTypes_1.Entity(); entity.LogicalName = entityName; entity.Attributes = {}; for (var prop in attributes) { var attributeValue = null; // get the attribute from metadata var attributeMetadata = MetadataUtil_1.MetadataUtil.getAttributeMetadata(this, entityName, prop.toLocaleLowerCase()); if (attributeMetadata) { if (attributes[prop] !== null) { if (attributeMetadata.AttributeType == CRMDataTypes_1.AttributeTypeCode[CRMDataTypes_1.AttributeTypeCode.String] || attributeMetadata.AttributeType == CRMDataTypes_1.AttributeTypeCode[CRMDataTypes_1.AttributeTypeCode.Memo]) { attributeValue = this.ConvertToString(prop, attributes[prop]); } else if (attributeMetadata.AttributeType == CRMDataTypes_1.AttributeTypeCode[CRMDataTypes_1.AttributeTypeCode.DateTime]) { attributeValue = this.ConvertToDate(attributes[prop], attributeMetadata); } else if (attributeMetadata.AttributeType == CRMDataTypes_1.AttributeTypeCode[CRMDataTypes_1.AttributeTypeCode.Lookup] || attributeMetadata.AttributeType == CRMDataTypes_1.AttributeTypeCode[CRMDataTypes_1.AttributeTypeCode.Customer] || attributeMetadata.AttributeType == CRMDataTypes_1.AttributeTypeCode[CRMDataTypes_1.AttributeTypeCode.Owner]) { attributeValue = this.ConvertToEntityReference(attributes[prop], attributeMetadata); } else if (attributeMetadata.AttributeType == CRMDataTypes_1.AttributeTypeCode[CRMDataTypes_1.AttributeTypeCode.Picklist]) { attributeValue = this.ConvertToOptionset(attributes[prop], attributeMetadata); } else if (attributeMetadata.AttributeType == CRMDataTypes_1.AttributeTypeCode[CRMDataTypes_1.AttributeTypeCode.Boolean]) { attributeValue = this.ConvertToBoolean(attributes[prop], attributeMetadata); } else if (attributeMetadata.AttributeType == CRMDataTypes_1.AttributeTypeCode[CRMDataTypes_1.AttributeTypeCode.PartyList]) { attributeValue = this.ConvertToPartyList(attributes[prop], attributeMetadata); } else { debug(&quot;Attribute '&quot; + prop + &quot;' type '&quot; + attributeMetadata.AttributeType + &quot;' not converted. Using the raw value&quot;); attributeValue = attributes[prop]; } } // TODO: add the rest of value types entity.Attributes[attributeMetadata.LogicalName] = attributeValue; } else { console.log(&quot;*** Attribute '&quot; + prop + &quot;' not found in metadata. Skipping...&quot;); } } // TODO: Set the Entity Id debug(&quot;Converted value:&quot;); debug(entity); return entity; }; CRMClient.prototype.ConvertToString = function (attributeName, attributeValue) { var strValue = null; if (attributeValue !== null &amp;&amp; attributeValue !== undefined) { if (typeof attributeValue === &quot;string&quot;) { strValue = attributeValue; } else if (attributeValue.toString !== undefined &amp;&amp; typeof attributeValue.toString === &quot;function&quot;) { strValue = attributeValue.toString(); } else { throw new Error(&quot;Cannot convert attribute '&quot; + attributeName + &quot;' value '&quot; + attributeValue + &quot;' from '&quot; + typeof attributeValue + &quot;' to 'String'&quot;); } } return strValue; }; CRMClient.prototype.ConvertToPartyList = function (attributeValue, attributeMetadata) { var partyList = []; if (attributeValue instanceof Array) { for (var i = 0; i &lt; attributeValue.length; i++) { var partyItem = attributeValue[i]; var partyItemRecord = { partyid: partyItem }; var convertedPartyItem = this.ConvertToEntity(&quot;activityparty&quot;, partyItemRecord); partyList.push(convertedPartyItem); } } else { throw new Error(&quot;Cannot convert attribute '&quot; + attributeMetadata.LogicalName + &quot;' value '&quot; + attributeValue + &quot;' from '&quot; + typeof attributeValue + &quot;' to 'ActivityParty'&quot;); } return partyList; }; CRMClient.prototype.ConvertToDate = function (attributeValue, attributeMetadata) { var date = null; if (attributeValue instanceof Date) { date = attributeValue; } else if (typeof attributeValue == &quot;string&quot;) { date = new Date(attributeValue); } if (date === null) throw new Error(&quot;Cannot convert attribute '&quot; + attributeMetadata.LogicalName + &quot;' value '&quot; + attributeValue + &quot;' from '&quot; + typeof attributeValue + &quot;' to 'Date'&quot;); return date; }; CRMClient.prototype.ConvertToBoolean = function (attributeValue, attributeMetadata) { var boolVal = null; if (typeof attributeValue == &quot;boolean&quot;) { boolVal = attributeValue; } else if (typeof attributeValue == &quot;number&quot;) { if (attributeValue == 0) { boolVal = false; } else { boolVal = true; } } else if (typeof attributeValue == &quot;string&quot;) { // Try to find the string as an Optionset Label var optionSet = attributeMetadata.OptionSet; if (optionSet.TrueOption.Label.UserLocalizedLabel.Label.toLowerCase() == attributeValue.toLowerCase() || attributeValue.toLowerCase() == &quot;yes&quot;) { boolVal = true; } else if (optionSet.FalseOption.Label.UserLocalizedLabel.Label.toLowerCase() == attributeValue.toLowerCase() || attributeValue.toLowerCase() == &quot;no&quot;) { boolVal = false; } } if (boolVal == null) { throw new Error(&quot;Can't convert attribute '&quot; + attributeMetadata.LogicalName + &quot;' value '&quot; + attributeValue + &quot;' from '&quot; + typeof attributeValue + &quot;' to Boolean&quot;); } return boolVal; }; CRMClient.prototype.ConvertToOptionset = function (attributeValue, attributeMetadata) { var optionSet = null; if (typeof attributeValue == &quot;number&quot;) { optionSet = new CRMDataTypes_1.OptionSetValue(attributeValue); } if (typeof attributeValue == &quot;string&quot;) { // Try to find the string as an Optionset Label var optionSetMetadata = attributeMetadata.OptionSet; for (var i = 0; i &lt; optionSetMetadata.Options.length; i++) { var option = optionSetMetadata.Options[i]; if (option.Label.UserLocalizedLabel.Label.toLowerCase() == attributeValue.toLowerCase()) { optionSet = new CRMDataTypes_1.OptionSetValue(option.Value); break; } } } if (optionSet == null) { throw new Error(&quot;Can't convert attribute '&quot; + attributeMetadata.LogicalName + &quot;' value '&quot; + attributeValue + &quot;' from '&quot; + typeof attributeValue + &quot;' to OptionsetValue&quot;); } return optionSet; }; CRMClient.prototype.ConvertToEntityReference = function (attributeValue, attributeMetadata) { var er = null; var target = null, id = null; if (typeof attributeValue == &quot;string&quot;) { // TODO: If the value is not a GUID, find the value in the target entity if (attributeMetadata.Targets.length &gt; 1) throw new Error(&quot;Couldn't get a valid target for attribute '&quot; + attributeMetadata.LogicalName + &quot;'. Please specify a valid target using {id:string,type:string}&quot;); target = attributeMetadata.Targets[0]; id = attributeValue; } else if (typeof attributeValue == &quot;object&quot;) { id = attributeValue.id; target = attributeValue.type; } if (!(target &amp;&amp; id)) throw new Error(&quot;Couldn't get a valid EntityReference value for attribute '&quot; + attributeMetadata.LogicalName + &quot;'. Please specify a valid target using {id:string,type:string}&quot;); er = new CRMDataTypes_1.EntityReference(id, target); return er; }; /** * Deletes one on more records in CRM, and returns the number of records affected. * @method CRMClient#delete * @param entityName {string} Name of the entity which record you want to delete * @param idsOrConditions {string|Guid|string[]|object} Can be either a Guid, a string, an array or a conditions object. * If it is Guid will delete the record with the specified id. * If it is a string, must be a Guid value, and again, will delete the records matching the specified id. * If the parameter is an array, each element in it must be either a string or a Guid, and in each case, the records deleted will be the ones specified by these Guids. * If it is a condition object, first, all the matching records will be retrieved, and then deleted. * Learn how to write condition objects: {@link Fetch#setFilter} * @returns {number} Number of records deleted * @example &lt;caption&gt;Delete an account with a known Guid&lt;/caption&gt; * var affectedRecords = crm.delete(&quot;account&quot;,&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;); * @example &lt;caption&gt;Delete an account with a known Guid. A validation of the Guid format will be performed before calling to the method.&lt;/caption&gt; * var affectedRecords = crm.delete(&quot;account&quot;,new Guid(&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;)); * @example &lt;caption&gt;Delete several account records at once&lt;/caption&gt; * var affectedRecords = crm.delete(&quot;account&quot;,[&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;,&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;); * @example &lt;caption&gt;Delete all existing accounts named &quot;contoso&quot;&lt;/caption&gt; * var affectedRecords = crm.delete(&quot;account&quot;,{name:&quot;contoso&quot;}); */ CRMClient.prototype.delete = function (entityName, idsOrConditions) { var ids; var recordsAffected = 0; if (!entityName) throw new Error(&quot;Entity name not specified&quot;); entityName = entityName.toLowerCase(); // normalize casing if (idsOrConditions instanceof Guid_1.Guid) { ids = [idsOrConditions.getValue()]; } else if (typeof idsOrConditions == &quot;string&quot;) { if (!Guid_1.Guid.isGuid(idsOrConditions)) throw new Error(&quot;Invalid GUID value&quot;); ids = [idsOrConditions]; } else if (Array.isArray(ids)) { for (var i = 0; i &lt; ids.length; i++) { var item = ids[i]; if (!(item instanceof Guid_1.Guid) || Guid_1.Guid.isGuid(item)) { throw new Error(&quot;Invalid GUID&quot;); } } ids = idsOrConditions; } else if (typeof idsOrConditions == &quot;object&quot; &amp;&amp; !(idsOrConditions instanceof Date)) { // Get the records that meet the specified criteria var idField = this.getIdField(entityName); var foundRecords = this.retrieveMultiple(entityName, idsOrConditions, idField); ids = []; for (var i = 0; i &lt; foundRecords.rows.length; i++) { ids.push(foundRecords.rows[i][idField]); } } recordsAffected = this.deleteMultiple(entityName, ids); return recordsAffected; }; CRMClient.prototype.deleteMultiple = function (entityName, ids) { var recordsAffected = 0; for (var i = 0; i &lt; ids.length; i++) { var params = { entityName: entityName, id: ids[i] }; this._crmBridge.Delete(params, true); recordsAffected++; } return recordsAffected; }; /** * Updates one or more records that meet the specified conditions and returns the number of updated records. * @method CRMClient#update * @param entityName {string} The name of the entity which record you want to update. * @param attributes {object} Javascript object with the values the new record will have. * @param conditions {opbject} Optional. Javascript condition object with the filter values that is going to be used to know which records are going to be updated. * If you omit this parameter, then you have to provide the record GUID in the attributes parameter. * Learn how to write condition objects: {@link Fetch#setFilter} * @returns {number} Number of modified records * * @example &lt;caption&gt;Updates all the accounts which name is contoso, and set the attribute value to &quot;contoso-updated&quot;&lt;/caption&gt; * var affectedRecords = crm.update(&quot;account&quot;,{name:&quot;contoso-updated&quot;},{name:&quot;contoso&quot;}) * @example &lt;caption&gt;In this example, only the account with the specified account id will be updated. If the specified record id exists, then affectedRecords will be equals to 1.&lt;/caption&gt; * var affectedRecords = crm.update(&quot;account&quot;,{accountid:&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;,name:&quot;contoso-updated&quot;}) */ CRMClient.prototype.update = function (entityName, attributes, conditions) { var updatedRecordsCount = 0; if (!entityName) throw new Error(&quot;Entity name not specified&quot;); entityName = entityName.toLowerCase(); // normalize casing debug(&quot;Preparing to update a record...&quot;); // get records GUIDS if (conditions != undefined) { var idField = this.getIdField(entityName); debug(&quot;Conditions specified. Trying to find which records that meets conditions to update...&quot;); var foundRecords = this.retrieveMultiple(entityName, conditions, idField); debug(foundRecords.rows.length + &quot; records found&quot;); for (var i = 0; i &lt; foundRecords.rows.length; i++) { debug(&quot;updating &quot; + i + &quot; of &quot; + foundRecords.rows.length); var foundRecordId = foundRecords.rows[i][idField]; attributes[idField] = foundRecordId; var entity = this.ConvertToEntity(entityName, attributes); this._crmBridge.Update(entity, true); } updatedRecordsCount = foundRecords.rows.length; } else { // the attributes parameter must contain the entity id on it var entity = this.ConvertToEntity(entityName, attributes); this._crmBridge.Update(entity, true); updatedRecordsCount = 1; } return updatedRecordsCount; }; CRMClient.prototype.getIdField = function (entityName) { var idAttr = null; var metadata = this.getEntityMetadata(entityName); if (metadata) { // Find the primary Attribute idAttr = metadata.PrimaryIdAttribute; } if (idAttr == null) throw new Error(&quot;Primary Attribute not found for entity &quot; + entityName); debug(&quot;idAttr for entity '&quot; + entityName + &quot;': '&quot; + idAttr + &quot;'&quot;); // convert it to lowercase return idAttr.toLowerCase(); }; /** Takes a list of attributes and values, tries to find an existing record with those values in CRM, if it exists, * then performs an update, otherwhise it creates it. * @method CRMClient#createOrUpdate * @param entityName {string} Name of the entity which record you want to update. * @param attributes {object} Javascript object with the attributes you want to create or update. * @param matchFields {string[]} List of fields in the attributes parameter you want to use to know if the record exists in CRM. * The attributes specified in this parameter will be used to perform a {@link CRMClient#retrieve}. * @example &lt;caption&gt;Create an account named &quot;contoso&quot;. In this case, a retrieve of an account with name=&quot;contoso&quot; will be performed. * If exists, then the name and description will be updated. If it doesn't exist, then the account will be created with the specified * name and description. If theres more than one account with that name, an exception will be thrown&lt;/caption&gt; * crm.createOrUpdate(&quot;account&quot;,{name:&quot;contoso&quot;, description:&quot;Account Updated&quot;},[&quot;name&quot;]); * @example &lt;caption&gt;Searches for an account named &quot;contoso&quot; owned by me. If exists, it updates it, otherwhise it creates a new one.&lt;/caption&gt; * var me = crm.whoAmI().UserId; * crm.createOrUpdate(&quot;account&quot;,{name:&quot;contoso&quot;, description:&quot;Account Updated&quot;, ownerid:me},[&quot;name&quot;,&quot;ownerid&quot;]); */ CRMClient.prototype.createOrUpdate = function (entityName, attributes, matchFields) { this.createUpdate(entityName, attributes, matchFields); }; /** For every record in the specified Table, tries to find out if it does exists, and if doesn't it creates it. * @method CRMClient#createIfDoesNotExist * @param data {DataTable} DataTable with the entity name and the records to create in CRM. * @param matchFields {string[]} List of fields in the attributes parameter you want to use to know if the record exists in CRM. * The attributes specified in this parameter will be used to perform a {@link CRMClient#retrieve}. * @example &lt;caption&gt;Loads a list of accounts from an Excel file and creates only the ones that don't exist already in CRM. * It uses the email address to know if the account exists or not.&lt;/caption&gt; * var accountsToLoad = DataTable.load(&quot;AccountsToLoad.xlsx&quot;); * crm.createIfDoesNotExist(accountsToLoad,[&quot;emailaddress1&quot;]); */ /** Takes a list of attributes and values, tries to find an existing record with those values in CRM, and if doesn't exists it creates it. * @method CRMClient#createIfDoesNotExist * @param entityName {string} Name of the entity which record you want to create. * @param attributes {object} Javascript object with the attributes you want to create. * @param matchFields {string[]} List of fields in the attributes parameter you want to use to know if the record exists in CRM. * The attributes specified in this parameter will be used to perform a {@link CRMClient#retrieve}. * @example &lt;caption&gt;Create an account named &quot;contoso&quot; only if it doesn't exist one already with the specified email. * If theres more than one account with that email, an exception will be thrown&lt;/caption&gt; * crm.createIfDoesNotExist(&quot;account&quot;,{name:&quot;contoso&quot;, description:&quot;New Account Created&quot;, emailaddress1:&quot;info@contoso.com&quot;},[&quot;emailaddress1&quot;]); * @example &lt;caption&gt;Searches for an account named &quot;contoso&quot; owned by me. If it doesn't exist, it creates it.&lt;/caption&gt; * var me = crm.whoAmI().UserId; * crm.createIfDoesNotExist(&quot;account&quot;,{name:&quot;contoso&quot;, description:&quot;Account Updated&quot;, ownerid:me},[&quot;name&quot;,&quot;ownerid&quot;]); */ CRMClient.prototype.createIfDoesNotExist = function (entityNameOrDataTable, attributesOrMatchfields, matchFields) { if (entityNameOrDataTable instanceof DataTable_1.DataTable) { var data = entityNameOrDataTable; if (data === undefined || data === null) throw new Error(&quot;DataTable not specified&quot;); if (data.name === undefined || data.name === null) throw new Error(&quot;DataTable name not specified&quot;); if (!Array.isArray(attributesOrMatchfields)) throw new Error(&quot;Wrong data type for the matchFields parameter&quot;); var matchFields = attributesOrMatchfields; debug(&quot;About to create if does not exits &quot; + data.rows.length + &quot; records from a DataTable...&quot;); for (var i = 0; i &lt; data.rows.length; i++) { debug(i + &quot; of &quot; + data.rows.length + &quot;...&quot;); this.createUpdate(data.name, data.rows[i], matchFields, false); } } else { if (matchFields === undefined || matchFields === null) throw new Error(&quot;matchFields not specified&quot;); this.createUpdate(entityNameOrDataTable, attributesOrMatchfields, matchFields, false); } }; CRMClient.prototype.createUpdate = function (entityName, attributes, matchFields, update) { if (update === void 0) { update = true; } var idField = this.getIdField(entityName); var conditions = {}; debug(&quot;About to create or update a record...&quot;); for (var i = 0; i &lt; matchFields.length; i++) { var matchField = matchFields[i]; debug(&quot;Preparing query to know if the record exists...&quot;); var attr = MetadataUtil_1.MetadataUtil.getAttributeMetadata(this, entityName, matchField); if (attr === null) throw new Error(&quot;Attribute '&quot; + matchField + &quot;' not found in entity &quot; + entityName); if (attributes[matchField] !== undefined &amp;&amp; attributes[matchField] !== null) { conditions[attr.LogicalName] = attributes[matchField]; } } // check if the record exists var foundRecords = this.retrieveMultiple(entityName, conditions, idField); if (foundRecords &amp;&amp; foundRecords.rows.length &gt; 0) { debug(foundRecords.rows.length + &quot; '&quot; + entityName + &quot;' records found&quot;); if (update) { if (foundRecords.rows.length &gt; 1) throw new Error(&quot;Too many records found&quot;); var foundRecord = foundRecords.rows[0]; attributes[idField] = foundRecord[idField]; this.update(entityName, attributes); } } else { debug(&quot;The record doesn't exists. Create it&quot;); this.create(entityName, attributes); } }; /** */ CRMClient.prototype.associateData = function (data) { for (var i = 0; i &lt; data.rows.length; i++) { var row = data.rows[i]; this.associate(row.from.type, row.from.value, data.name, row.to.type, row.to.value); } }; CRMClient.prototype.associate = function (fromEntityName, fromEntityId, relationshipName, toEntityName, toEntityId) { // perform some validations if (!fromEntityName) throw new Error(&quot;From entity name not specified&quot;); fromEntityName = fromEntityName.toLowerCase(); // normalize casing if (!toEntityName) throw new Error(&quot;To entity name not specified&quot;); toEntityName = toEntityName.toLowerCase(); // normalize casing if (!fromEntityId) throw new Error(&quot;fromEntityId not specified&quot;); if (!toEntityId) throw new Error(&quot;toEntityId not specified&quot;); var fromId, toId; if (fromEntityId instanceof Guid_1.Guid) { fromId = fromEntityId.getValue(); } else { fromId = fromEntityId; } if (toEntityId instanceof Guid_1.Guid) { toId = toEntityId.getValue(); } else { toId = toEntityId; } var params = { entityName: fromEntityName, entityId: fromId, relationship: relationshipName, relatedEntities: [{ entityName: toEntityName, entityId: toId }] }; this._crmBridge.Associate(params, true); }; CRMClient.prototype.disassociateData = function (data) { for (var i = 0; i &lt; data.rows.length; i++) { var row = data.rows[i]; this.disassociate(row.from.type, row.from.value, data.name, row.to.type, row.to.value); } }; CRMClient.prototype.disassociate = function (fromEntityName, fromEntityId, relationshipName, toEntityName, toEntityId) { // perform some validations if (!fromEntityName) throw new Error(&quot;From entity name not specified&quot;); fromEntityName = fromEntityName.toLowerCase(); // normalize casing if (!toEntityName) throw new Error(&quot;To entity name not specified&quot;); toEntityName = toEntityName.toLowerCase(); // normalize casing if (!fromEntityId) throw new Error(&quot;fromEntityId not specified&quot;); if (!toEntityId) throw new Error(&quot;toEntityId not specified&quot;); var fromId, toId; if (fromEntityId instanceof Guid_1.Guid) { fromId = fromEntityId.getValue(); } else { fromId = fromEntityId; } if (toEntityId instanceof Guid_1.Guid) { toId = toEntityId.getValue(); } else { toId = toEntityId; } var params = { entityName: fromEntityName, entityId: fromId, relationship: relationshipName, relatedEntities: [{ entityName: toEntityName, entityId: toId }] }; this._crmBridge.Disassociate(params, true); }; /** Gets metadata information for a particular CRM Entity. * @method CRMClient#getEntityMetadata * @param entityName {string} Name of the entity which metadata information you want to get * @example &lt;caption&gt;Retrieve metadata information of the account entity&lt;/caption&gt; * var metadata = crm.getEntityMetadata(&quot;account&quot;); */ CRMClient.prototype.getEntityMetadata = function (entityName) { return MetadataUtil_1.MetadataUtil.getEntityMetadata(this, entityName); }; CRMClient.prototype.Execute = function (request) { var response = this._crmBridge.Execute(request, true); return response; }; CRMClient.prototype.assign = function (targetId, targetType, assigneeId, assigneeType) { // set the default value if (assigneeType === undefined) assigneeType = &quot;systemuser&quot;; var request = new Messages_1.AssignRequest(); request.Assignee = new CRMDataTypes_1.EntityReference(assigneeId.toString(), assigneeType); request.Target = new CRMDataTypes_1.EntityReference(targetId.toString(), targetType); var response = this.Execute(request); }; CRMClient.prototype.export = function (entityName, fileName) { ImportExportUtil_1.ImportExportUtil.export(this, entityName, fileName); }; CRMClient.prototype.import = function (fileName) { ImportExportUtil_1.ImportExportUtil.import(this, fileName); }; /** Sets the state and status of a record. * @method CRMClient#setState * @param entityName {string} Name of the entity which state or status you want to set * @param entityId {Guid|string} GUID of the record which state or status you want to set * @param state {number|string} Name or Value of the State you want to set * @param status {number|string} Name or Value of the Status you want to set * @example &lt;caption&gt;Set the state of a task to Completed (1) and the Status to Completed (5)&lt;/caption&gt; * crm.setState('task','6fefeb79-5447-e511-a5db-0050568a69e2',1,5); * @example &lt;caption&gt;Set the state of a task using the text values&lt;/caption&gt; * crm.setState('task','6fefeb79-5447-e511-a5db-0050568a69e2','Completed','Completed'); * */ CRMClient.prototype.setState = function (entityName, entityId, state, status) { StateUtil_1.StateUtil.setState(this, entityName, entityId, state, status); }; return CRMClient; }()); exports.CRMClient = CRMClient; //# sourceMappingURL=CRMClient.js.map × Search results Close "},"DataTableSerializer.js.html":{"id":"DataTableSerializer.js.html","title":"Source: DataTableSerializer.js","body":" DynamicsNode Classes CRMClientDataTableDataTableJsonSerializerDataTableSerializerDataTableXlsSerializerDataTableXmlSerializerFetchFilterGuid Tutorials CommandsAndReplCompileAndTesting Global Global Source: DataTableSerializer.js &quot;use strict&quot;; Object.defineProperty(exports, &quot;__esModule&quot;, { value: true }); var DataTableJsonSerializer_1 = require(&quot;./DataTableJsonSerializer&quot;); var DataTableXmlSerializer_1 = require(&quot;./DataTableXmlSerializer&quot;); var DataTableXlsSerializer_1 = require(&quot;./DataTableXlsSerializer&quot;); var path = require(&quot;path&quot;); var fs = require(&quot;fs&quot;); /** Default constructor * @class DataTableSerializer * @classdesc Utility to load and save DataTable objects to different file formats. * More Info: {@link DataTableJsonSerializer} {@link DataTableXlsSerializer} {@link DataTableXmlSerializer} */ var DataTableSerializer = (function () { function DataTableSerializer() { } DataTableSerializer.getSerializer = function (extension) { var retVal = null; if (extension !== null &amp;&amp; extension.length &gt; 0) { // remove first '.' if the extension begins with it if (extension.indexOf(&quot;.&quot;) == 0) extension = extension.substr(1); for (var i = 0; i &lt; this.AvailableSerializers.length; i++) { var serializer = this.AvailableSerializers[i]; if (serializer.extension &amp;&amp; serializer.extension.toLocaleLowerCase() == extension.toLowerCase()) { retVal = serializer; break; } } } return retVal; }; DataTableSerializer.save = function (dataTable, fileName) { var ext = path.extname(fileName); var serializer = this.getSerializer(ext); if (serializer === null) throw new Error(&quot;Format '&quot; + ext + &quot;' not supported&quot;); var data = serializer.serialize(dataTable); fs.writeFileSync(fileName, data); }; /** The path is relative to process.cwd() */ DataTableSerializer.load = function (fileName) { var dt; var ext = path.extname(fileName); var serializer = this.getSerializer(ext); if (serializer === null) throw new Error(&quot;Format '&quot; + ext + &quot;' not supported&quot;); var buffer = fs.readFileSync(fileName); dt = serializer.deserialize(buffer); return dt; }; return DataTableSerializer; }()); /** @lends DataTableSerializer */ // register serializers here DataTableSerializer.AvailableSerializers = [ new DataTableJsonSerializer_1.DataTableJsonSerializer(), new DataTableXlsSerializer_1.DataTableXlsSerializer(), new DataTableXmlSerializer_1.DataTableXmlSerializer() ]; exports.DataTableSerializer = DataTableSerializer; //# sourceMappingURL=DataTableSerializer.js.map × Search results Close "},"DataTableXlsSerializer.js.html":{"id":"DataTableXlsSerializer.js.html","title":"Source: DataTableXlsSerializer.js","body":" DynamicsNode Classes CRMClientDataTableDataTableJsonSerializerDataTableSerializerDataTableXlsSerializerDataTableXmlSerializerFetchFilterGuid Tutorials CommandsAndReplCompileAndTesting Global Global Source: DataTableXlsSerializer.js &quot;use strict&quot;; Object.defineProperty(exports, &quot;__esModule&quot;, { value: true }); var XLSX = require(&quot;xlsx&quot;); var DataTable_1 = require(&quot;./DataTable&quot;); var WorkBook = (function () { function WorkBook() { } return WorkBook; }()); var WorkSheet = (function () { function WorkSheet() { } return WorkSheet; }()); /** Default constructor * @class DataTableXlsSerializer * @classdesc Saves and loads a {@link DataTable} object to and from a MS Excel file (xlsx). * When reading from an Excel file, the data is taken from the first sheet in the workbook. * It is assumed that the first row contains the column names. * When serializing, the name of the sheet containing the data will be the name in the DataTable object. */ var DataTableXlsSerializer = (function () { function DataTableXlsSerializer() { this.extension = &quot;xlsx&quot;; } /** Serializes the specified {@link DataTable} object into a Buffer data. * @method DataTableXlsSerializer#serialize */ DataTableXlsSerializer.prototype.serialize = function (dataTable) { var wb = new WorkBook(); var ws = new WorkSheet(); wb.Sheets = {}; var sheetName = dataTable.name || &quot;DynamicsNode&quot;; wb.Sheets[sheetName] = ws; wb.SheetNames = [sheetName]; // Holds the list of columns in the dataTable var columnNames = []; for (var rowIndex = 0; rowIndex &lt; dataTable.rows.length; rowIndex++) { var row = dataTable.rows[rowIndex]; for (var colName in row) { if (row.hasOwnProperty(colName)) { var colValue = row[colName]; if (colValue !== null) { var colIndex = this.getColIndex(colName, columnNames); var cellRef = XLSX.utils.encode_cell({ c: colIndex, r: rowIndex + 1 }); var cellType = this.getCellType(colValue); // convert to milliseconds var isDate = colValue instanceof Date; if (isDate) colValue = colValue.valueOf(); var cell = { v: colValue, t: cellType }; if (isDate) cell.z = XLSX.SSF._table[14]; ws[cellRef] = cell; } } } } // add the column names for (var colIndex = 0; colIndex &lt; columnNames.length; colIndex++) { var columnName = columnNames[colIndex]; var cellRef = XLSX.utils.encode_cell({ c: colIndex, r: 0 }); var cell = { v: columnName, t: 's' }; ws[cellRef] = cell; } var range; var encodedRange; var rangeColumnsTo = columnNames.length &gt; 0 ? columnNames.length - 1 : 0; var rangeRowsTo = dataTable.rows.length; if (rangeColumnsTo == 0 &amp;&amp; rangeRowsTo == 0) { encodedRange = &quot;A1:A1&quot;; } else { range = { e: { c: 0, r: 0 }, s: { c: rangeColumnsTo, r: rangeRowsTo } }; encodedRange = XLSX.utils.encode_range(range.e, range.s); } ws['!ref'] = encodedRange; var serialized = XLSX.write(wb, { bookType: 'xlsx', type: 'buffer' }); return serialized; }; DataTableXlsSerializer.prototype.getCellType = function (value) { var type = 's'; if (typeof value === 'number') { type = 'n'; } else if (typeof value === 'boolean') { type = 'b'; } else if (value instanceof Date) { type = 'n'; } return type; }; /** Gets the index of the column. If it doesn't exist, it adds it to the columns array */ DataTableXlsSerializer.prototype.getColIndex = function (colName, columns) { var index = columns.indexOf(colName); if (index == -1) { columns.push(colName); index = columns.length - 1; } return index; }; /** Deserializes the specified buffer data into a {@link DataTable} object * @method DataTableXlsSerializer#deserialize */ DataTableXlsSerializer.prototype.deserialize = function (data) { var dt = new DataTable_1.DataTable(); var workBook = XLSX.read(data); var sheetName = workBook.SheetNames[0]; var workSheet = workBook.Sheets[sheetName]; dt.name = sheetName; var rangeName = workSheet[&quot;!ref&quot;]; var range = XLSX.utils.decode_range(rangeName); var from = range.s, to = range.e; // Assume the firs row contains column names // TODO: Make this optional for (var rowIndex = from.r + 1, tableRowIndex = 0; rowIndex &lt;= to.r; rowIndex++, tableRowIndex++) { var row = {}; for (var colIndex = from.c, tableColIndex = 0; colIndex &lt;= to.c; colIndex++, tableColIndex++) { // Get the column name var nameColRange = XLSX.utils.encode_cell({ r: from.r, c: colIndex }); var colName = workSheet[nameColRange]; var currentRange = XLSX.utils.encode_cell({ r: rowIndex, c: colIndex }); var colValue = workSheet[currentRange]; if (colName !== undefined &amp;&amp; colName.v !== null &amp;&amp; colName.v !== null &amp;&amp; colValue !== undefined &amp;&amp; colValue.v !== undefined &amp;&amp; colValue.v !== null) { row[colName.v] = colValue.v; } } dt.rows.push(row); } return dt; }; return DataTableXlsSerializer; }()); exports.DataTableXlsSerializer = DataTableXlsSerializer; //# sourceMappingURL=DataTableXlsSerializer.js.map × Search results Close "},"ImportExportUtil.js.html":{"id":"ImportExportUtil.js.html","title":"Source: ImportExportUtil.js","body":" DynamicsNode Classes CRMClientDataTableDataTableJsonSerializerDataTableSerializerDataTableXlsSerializerDataTableXmlSerializerFetchFilterGuid Tutorials CommandsAndReplCompileAndTesting Global Global Source: ImportExportUtil.js &quot;use strict&quot;; Object.defineProperty(exports, &quot;__esModule&quot;, { value: true }); var DataTableSerializer_1 = require(&quot;./DataTableSerializer&quot;); var info = require(&quot;debug&quot;)(&quot;dynamicsnode:info&quot;); var ImportExportUtil = (function () { function ImportExportUtil() { } /** Exports all the existing records of a given entity to the specified file */ ImportExportUtil.export = function (client, entityName, fileName) { info(&quot;Exporting &quot; + entityName + &quot; to &quot; + fileName + &quot;...&quot;); // perform some validations if (!entityName) throw new Error(&quot;Entity name not specified&quot;); entityName = entityName.toLowerCase(); // normalize casing info(&quot;Getting metadata...&quot;); var metadata = client.getEntityMetadata(entityName); info(&quot;Getting data...&quot;); var data = client.retrieveMultiple(entityName, {}); var rowsCount = data ? data.rows ? data.rows.length : 0 : 0; info(&quot;Retrieved &quot; + rowsCount + &quot; records&quot;); info(&quot;Saving...&quot;); DataTableSerializer_1.DataTableSerializer.save(data, fileName); }; /** Loads the specified file in CRM. If the record exists, then it updates. Otherwhise, it creates it. */ ImportExportUtil.import = function (client, fileName) { info(&quot;Importing &quot; + fileName + &quot;...&quot;); info(&quot;Loading data table...&quot;); var dt = DataTableSerializer_1.DataTableSerializer.load(fileName); info(dt.rows.length + &quot; records found&quot;); info(&quot;Getting metadata for entity &quot; + dt.name + &quot;...&quot;); var metadata = client.getEntityMetadata(dt.name); var idField = client.getIdField(dt.name); info(&quot;Importing...&quot;); for (var i = 0; i &lt; dt.rows.length; i++) { info(&quot;record &quot; + (i + 1) + &quot; of &quot; + dt.rows.length + &quot;...&quot;); client.createOrUpdate(dt.name, dt.rows[i], [idField]); } }; return ImportExportUtil; }()); exports.ImportExportUtil = ImportExportUtil; //# sourceMappingURL=ImportExportUtil.js.map × Search results Close "},"MetadataUtil.js.html":{"id":"MetadataUtil.js.html","title":"Source: MetadataUtil.js","body":" DynamicsNode Classes CRMClientDataTableDataTableJsonSerializerDataTableSerializerDataTableXlsSerializerDataTableXmlSerializerFetchFilterGuid Tutorials CommandsAndReplCompileAndTesting Global Global Source: MetadataUtil.js &quot;use strict&quot;; Object.defineProperty(exports, &quot;__esModule&quot;, { value: true }); var CRMDataTypes_1 = require(&quot;./CRMDataTypes&quot;); var Messages_1 = require(&quot;./Messages&quot;); var MetadataUtil = (function () { function MetadataUtil() { } MetadataUtil.getEntityMetadataFromCrm = function (crm, entityName) { var request = new Messages_1.RetrieveEntityRequest(entityName, CRMDataTypes_1.EntityFilters.All); var response = crm.Execute(request); return response.EntityMetadata; }; MetadataUtil.getEntityMetadata = function (crm, entityName) { if (this._metadataCache[entityName] === undefined) { var metadata = this.getEntityMetadataFromCrm(crm, entityName); this._metadataCache[entityName] = metadata; } return this._metadataCache[entityName]; }; MetadataUtil.getAttributeMetadata = function (crm, entityName, attributeName) { var attributeMetadata = null; var entityMetadata = this.getEntityMetadata(crm, entityName); if (entityMetadata &amp;&amp; entityMetadata.Attributes &amp;&amp; entityMetadata.Attributes.length &gt; 0) { for (var i = 0; i &lt; entityMetadata.Attributes.length; i++) { if (entityMetadata.Attributes[i].LogicalName == attributeName) { attributeMetadata = entityMetadata.Attributes[i]; break; } } // In case there isn't an attribute with the specified name, then try to find it by displayname if (attributeMetadata === null) { for (var i = 0; i &lt; entityMetadata.Attributes.length; i++) { if (entityMetadata.Attributes[i].DisplayName != null &amp;&amp; entityMetadata.Attributes[i].DisplayName.UserLocalizedLabel != null &amp;&amp; entityMetadata.Attributes[i].DisplayName.UserLocalizedLabel.Label != null &amp;&amp; entityMetadata.Attributes[i].DisplayName.UserLocalizedLabel.Label.toLowerCase() == attributeName.toLowerCase()) { attributeMetadata = entityMetadata.Attributes[i]; break; } } } } return attributeMetadata; }; /** Gets the optionset number value from its label value. If not found returns null */ MetadataUtil.getOptionsetValue = function (crm, entityName, attributeName, optionsetText) { var optionsetValue = null; var attribute = this.getAttributeMetadata(crm, entityName, attributeName); if (attribute === null) throw new Error(&quot;Attribute &quot; + attributeName + &quot; not found in entity '&quot; + entityName + &quot;'&quot;); var options = attribute.OptionSet.Options; for (var i = 0; i &lt; options.length; i++) { var option = options[i]; if (option &amp;&amp; option.Label &amp;&amp; option.Label.UserLocalizedLabel &amp;&amp; option.Label.UserLocalizedLabel.Label &amp;&amp; option.Label.UserLocalizedLabel.Label === optionsetText) { optionsetValue = option.Value; break; } } return optionsetValue; }; return MetadataUtil; }()); MetadataUtil._metadataCache = {}; exports.MetadataUtil = MetadataUtil; //# sourceMappingURL=MetadataUtil.js.map × Search results Close "},"DataTable.js.html":{"id":"DataTable.js.html","title":"Source: DataTable.js","body":" DynamicsNode Classes CRMClientDataTableDataTableJsonSerializerDataTableSerializerDataTableXlsSerializerDataTableXmlSerializerFetchFilterGuid Tutorials CommandsAndReplCompileAndTesting Global Global Source: DataTable.js &quot;use strict&quot;; Object.defineProperty(exports, &quot;__esModule&quot;, { value: true }); var DataTableSerializer_1 = require(&quot;./DataTableSerializer&quot;); var debug = require('debug')('dynamicsnode'); var DataTable = (function () { /** Default constructor * @class DataTable * @classdesc Represents a DataTable object. Contains methods to save and load the row values from a file. */ function DataTable(name, rows) { this.name = name; this.rows = []; if (rows !== undefined) { this.rows = rows; } } /** * Callback that receives a row of a data table and returns a value for a column * @callback DataTable~lookupCallback * @param {object} row Object containing the values of a row * @return {object} The value to apply to a specific column of that particular row */ /** Method to convert all the existing values in a column. * Iterates through all the existing rows, and for every value in the specified column calls to the specified callback method. * Then, the returning value will be applied to the column. * The idea behind this functionality is that you can resolve the lookup data that you may have in a DataTable, before sending * those values to CRM. * For example, you may want to load a list of contacts, and you want to associate your contacts to existing parent accounts. * What you can do, is use the phone number on the contact to try to find the parent account of the contact. * @param {string} columnName Name of the column which values are going to be updated * @param {DataTable~lookupCallback} updater Function that will process every record in the Table. * @method DataTable#lookup * @example &lt;caption&gt;Lookup using simple values&lt;/caption&gt; * var dt = new DataTable(); * dt.rows.push({val1:1,val2:2}, * {val1:2,val2:2}); * dt.lookup('val1',row=&gt;++row.val1); * console.log(dt.rows[0].val1); // prints out 2 * console.log(dt.rows[1].val1); // prints out 3 * @example &lt;caption&gt;Find the parent account of a contact using the phone number&lt;/caption&gt; * // create a contact using a data table and associate to the create account using the phone number * var dtContacts = DataTable.load(&quot;MyContactsToLoad.json&quot;); * * // resolve the parentcustomerid field * dtContacts.lookup(&quot;parentcustomerid&quot;,row=&gt;{ return {id:crm.retrieve(&quot;account&quot;,{telephone1:row.telephone1}).accountid,type:&quot;account&quot;}}); * * // create the record * crm.create(dtContacts); */ DataTable.prototype.lookup = function (columnName, updater, useCache) { if (useCache === void 0) { useCache = true; } var cache = {}; // Temporary cache debug(&quot;Resolving lookups for columm '&quot; + columnName + &quot;'. &quot; + (useCache ? &quot;Using Cache&quot; : &quot;&quot;) + &quot;...&quot;); for (var i = 0; i &lt; this.rows.length; i++) { debug(i + &quot; of &quot; + this.rows.length); var currentRow = this.rows[i]; var lookupValue = currentRow[columnName]; var resolvedValue = null; if (useCache &amp;&amp; lookupValue !== undefined &amp;&amp; lookupValue !== null &amp;&amp; cache[lookupValue] !== undefined) { debug(&quot;Resolved Lookup '&quot; + columnName + &quot;' value '&quot; + lookupValue + &quot;' using cache&quot;); resolvedValue = cache[lookupValue]; debug(&quot;resolved value: '&quot; + resolvedValue + &quot;'&quot;); } else { resolvedValue = updater(currentRow); if (useCache &amp;&amp; lookupValue !== undefined &amp;&amp; lookupValue !== null) { // add the resolved value to the cache cache[lookupValue] = resolvedValue; } } if (resolvedValue === undefined) { if (currentRow[columnName] !== undefined) { delete currentRow[columnName]; } } else { currentRow[columnName] = resolvedValue; } } }; /** Removes a column from the Table * @method DataTable#removeColumn * @param columnName {string} Name of the column to remove * @example &lt;caption&gt;Remove an existing column&lt;/caption&gt; * var dt = new DataTable(); * dt.rows.push({val1:1,val2:2}, * {val1:2,val2:2}); * dt.removeColumn('val1'); * console.log(dt.rows[0].val1); // prints undefined * console.log(dt.rows[1].val1); // prints undefined * console.log(dt.rows[0].val2); // prints 2 * console.log(dt.rows[1].val2); // prints 2 */ DataTable.prototype.removeColumn = function (columnName) { for (var i = 0; i &lt; this.rows.length; i++) { delete this.rows[i][columnName]; } }; /** Renames an existing column in the Table * @method DataTable#rename * @param columnName {string} Name of the existing column to rename * @param newName {string} New Name to apply to the column * @example &lt;caption&gt;Rename an existing column&lt;/caption&gt; * var dt = new DataTable(); * dt.rows.push({val1:1,val2:2}, * {val1:2,val2:2}); * dt.renameColumn('val1','val3'); * console.log(dt.rows[0].val1); // prints undefined * console.log(dt.rows[1].val1); // prints undefined * console.log(dt.rows[0].val2); // prints 2 * console.log(dt.rows[1].val2); // prints 2 * console.log(dt.rows[0].val3); // prints 1 * console.log(dt.rows[1].val3); // prints 2 */ DataTable.prototype.renameColumn = function (columnName, newName) { for (var i = 0; i &lt; this.rows.length; i++) { if (this.rows[i][columnName] !== undefined) { this.rows[i][newName] = this.rows[i][columnName]; delete this.rows[i][columnName]; } } }; /** Saves the specified datatable object to the specified file. * The format of the file depends on the extension provided. * The supported formats are json, xml and xlsx. * @method DataTable#save * @param {dataTable} DataTable Table to save to the specified file. * @param {fileName} string File path where to save the DataTable object. The path is relative to process.cwd() * @example &lt;caption&gt;Saves the datatable to a .json file&lt;/caption&gt; * var dt = new DataTable(); * dt.save('mydata.json'); */ DataTable.prototype.save = function (fileName) { DataTableSerializer_1.DataTableSerializer.save(this, fileName); }; /** * Loads the {@link DataTable} object from the specified file. * @memberof DataTable * @static * @param {fileName} string File path where to save the DataTable object. The path is relative to process.cwd() * @example &lt;caption&gt;Loads the table from an xlsx file&lt;/caption&gt; * var dt = DataTable.load('mydata.xlsx'); */ DataTable.load = function (fileName) { return DataTableSerializer_1.DataTableSerializer.load(fileName); }; return DataTable; }()); exports.DataTable = DataTable; //# sourceMappingURL=DataTable.js.map × Search results Close "},"DataTableJsonSerializer.js.html":{"id":"DataTableJsonSerializer.js.html","title":"Source: DataTableJsonSerializer.js","body":" DynamicsNode Classes CRMClientDataTableDataTableJsonSerializerDataTableSerializerDataTableXlsSerializerDataTableXmlSerializerFetchFilterGuid Tutorials CommandsAndReplCompileAndTesting Global Global Source: DataTableJsonSerializer.js &quot;use strict&quot;; Object.defineProperty(exports, &quot;__esModule&quot;, { value: true }); /** Default constructor * @class DataTableJsonSerializer * @classdesc Saves and loads a {@link DataTable} object to and from an json file. */ var DataTableJsonSerializer = (function () { function DataTableJsonSerializer() { this.extension = &quot;json&quot;; } /** Serializes the specified {@link DataTable} object into a Buffer data. * @method DataTableJsonSerializer#serialize */ DataTableJsonSerializer.prototype.serialize = function (dataTable) { return new Buffer(JSON.stringify(dataTable, null, 4), 'utf8'); }; /** Deserializes the specified buffer data into a {@link DataTable} object * @method DataTableJsonSerializer#deserialize */ DataTableJsonSerializer.prototype.deserialize = function (data) { return JSON.parse(data.toString('utf8'), DataTableJsonSerializer.JSONDataReviver); }; DataTableJsonSerializer.JSONDataReviver = function (key, str) { var result = str; if (typeof str === 'string' || str instanceof String) { var parsedValue = DataTableJsonSerializer.parseDates(str); if (parsedValue !== null) { result = parsedValue; } } return result; }; ; DataTableJsonSerializer.parseDates = function (str) { var result = null; var dateParts = /^(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.*(\\d*)Z$/.exec(str); if (dateParts !== null) { result = new Date(Date.UTC(+dateParts[1], +dateParts[2] - 1, +dateParts[3], +dateParts[4], +dateParts[5], +dateParts[6], +dateParts[7])); } return result; }; return DataTableJsonSerializer; }()); exports.DataTableJsonSerializer = DataTableJsonSerializer; //# sourceMappingURL=DataTableJsonSerializer.js.map × Search results Close "},"DataTableXmlSerializer.js.html":{"id":"DataTableXmlSerializer.js.html","title":"Source: DataTableXmlSerializer.js","body":" DynamicsNode Classes CRMClientDataTableDataTableJsonSerializerDataTableSerializerDataTableXlsSerializerDataTableXmlSerializerFetchFilterGuid Tutorials CommandsAndReplCompileAndTesting Global Global Source: DataTableXmlSerializer.js &quot;use strict&quot;; Object.defineProperty(exports, &quot;__esModule&quot;, { value: true }); var DataTable_1 = require(&quot;./DataTable&quot;); var XmlEncode_1 = require(&quot;./XmlEncode&quot;); var XMLWriter = require(&quot;xml-writer&quot;); var et = require(&quot;elementtree&quot;); /** Default constructor * @class DataTableXmlSerializer * @classdesc Saves and loads a {@link DataTable} object to and from an Xml file. */ var DataTableXmlSerializer = (function () { function DataTableXmlSerializer() { this.extension = 'xml'; } /** Serializes the specified {@link DataTable} object into a Buffer data. * @method DataTableXmlSerializer#serialize */ DataTableXmlSerializer.prototype.serialize = function (dataTable) { var returnValue; if (dataTable != null) { var xw = new XMLWriter(true); xw.startElement('DataTable'); if (dataTable.name) xw.writeAttribute(&quot;name&quot;, dataTable.name); for (var i = 0; i &lt; dataTable.rows.length; i++) { xw.startElement('row'); var rowItem = dataTable.rows[i]; for (var propName in rowItem) { var propValue = rowItem[propName]; if (propValue != null) { var strValue = null, propType = null; if (typeof propValue == &quot;object&quot; &amp;&amp; !(propValue instanceof Date) &amp;&amp; propValue.type !== null &amp;&amp; propValue.type !== undefined) { // this value must contain typeinfo propType = propValue.type; strValue = this.serializeValue(propValue.value); } else { strValue = this.serializeValue(propValue); } if (strValue !== null) { xw.startElement(XmlEncode_1.XmlEncode.encodeName(propName)); if (propType !== null &amp;&amp; propType !== undefined) { xw.writeAttribute(&quot;type&quot;, propValue.type); } xw.text(strValue); xw.endElement(); } } } xw.endElement(); // row } xw.endElement(); // DataTable returnValue = xw.toString(); } return new Buffer(returnValue, 'utf8'); }; /** Deserializes the specified buffer data into a {@link DataTable} object * @method DataTableXmlSerializer#deserialize */ DataTableXmlSerializer.prototype.deserialize = function (xmlContent) { var dt = new DataTable_1.DataTable(); var etree = et.parse(xmlContent.toString('utf8')); var rootElement = etree.getroot(); var attrName = rootElement.attrib[&quot;name&quot;]; if (attrName) dt.name = attrName; var rowElements = rootElement.getchildren(); for (var i = 0; i &lt; rowElements.length; i++) { var rowElement = rowElements[i]; var rowItem = {}; var rowFieldElements = rowElement.getchildren(); for (var j = 0; j &lt; rowFieldElements.length; j++) { var rowFieldElement = rowFieldElements[j]; var fieldName = XmlEncode_1.XmlEncode.decodeName(rowFieldElement.tag); var fieldValue = rowFieldElement.text; var fieldType = rowFieldElement.attrib[&quot;type&quot;]; var parsedValue = this.parseXmlValue(fieldValue); if (fieldType) { parsedValue = { type: fieldType, value: parsedValue }; } rowItem[fieldName] = parsedValue; } dt.rows.push(rowItem); } return dt; }; DataTableXmlSerializer.prototype.serializeValue = function (value) { var result = null; if (value !== null &amp;&amp; value !== undefined) { if (value instanceof Date) { result = JSON.stringify(value).replace(/\\&quot;/g, &quot;&quot;); } else { result = value.toString(); } } return result; }; DataTableXmlSerializer.prototype.parseXmlValue = function (strValue) { var result = strValue; var parsedValue = this.parseBooleans(strValue); if (parsedValue === null) { parsedValue = this.parseNumbers(strValue); } if (parsedValue === null) { parsedValue = this.parseDates(strValue); } if (parsedValue !== null) { result = parsedValue; } return result; }; DataTableXmlSerializer.prototype.parseNumbers = function (str) { var result = null; // http://stackoverflow.com/questions/18082/validate-decimal-numbers-in-javascript-isnumeric var isNumber = !Array.isArray(str) &amp;&amp; (+str - parseFloat(str) + 1) &gt;= 0; if (isNumber) { result = +str; } return result; }; ; DataTableXmlSerializer.prototype.parseBooleans = function (str) { var result = null; if (/^(?:true|false)$/i.test(str)) { result = str.toLowerCase() === 'true'; } return result; }; ; DataTableXmlSerializer.prototype.parseDates = function (str) { var result = null; var dateParts = /^(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.*(\\d*)Z$/.exec(str); if (dateParts !== null) { result = new Date(Date.UTC(+dateParts[1], +dateParts[2] - 1, +dateParts[3], +dateParts[4], +dateParts[5], +dateParts[6], +dateParts[7])); } return result; }; return DataTableXmlSerializer; }()); exports.DataTableXmlSerializer = DataTableXmlSerializer; //# sourceMappingURL=DataTableXmlSerializer.js.map × Search results Close "},"Fetch.js.html":{"id":"Fetch.js.html","title":"Source: Fetch.js","body":" DynamicsNode Classes CRMClientDataTableDataTableJsonSerializerDataTableSerializerDataTableXlsSerializerDataTableXmlSerializerFetchFilterGuid Tutorials CommandsAndReplCompileAndTesting Global Global Source: Fetch.js &quot;use strict&quot;; Object.defineProperty(exports, &quot;__esModule&quot;, { value: true }); var XMLWriter = require(&quot;xml-writer&quot;); var Fetch = (function () { /** Default Constructor * @class Fetch * @classdesc Provides properties and methods to create FetchXml queries * @param entityName {string} Optional. Name of the entity which the query is for * @param attr {string|boolean|string[]} Optional. Either a column name, or a list of column names, or a boolean value indicating that all the attribute values want to be retrieved. The default value is null, and means that only the primary attribute will be retrieved. * @param filterConditions {object} Optional. Object that describes conditions in an JSON notation. More Info: {@link Fetch#setFilter} * @example &lt;caption&gt;Create an empty FetchXml&lt;/caption&gt; * var fetch = new Fetch(); * console.log(fetch.toString()); // outputs: &lt;fetch&gt;&lt;entity&gt;&lt;/entity&gt;&lt;/fetch&gt; * @example &lt;caption&gt;Create a Fetch query for the &quot;account&quot;&quot; entity, with 3 attributes and one filter&lt;/caption&gt; * var fetch = new Fetch(&quot;account&quot;,[&quot;description&quot;,&quot;createdon&quot;,&quot;ownerid&quot;],{name:&quot;acme&quot;}); * @example &lt;caption&gt;Create a Fetch query for the &quot;account&quot;&quot; entity, with all attributes and one filter&lt;/caption&gt; * var fetch = new Fetch(&quot;account&quot;,true,{name:&quot;acme&quot;}); */ function Fetch(entityName, attr, filterConditions) { this.entityName = entityName; this.attributes = []; this.operatorNames = ['eq', 'neq', 'gt', 'ge', 'le', 'lt', 'like', 'not-like', 'in', 'not-in', 'between', 'not-between', 'null', 'not-null']; this.operatorJsonNames = ['$eq', '$neq', '$gt', '$ge', '$le', '$lt', '$like', '$notlLike', '$in', '$notIn', '$between', '$notBetween', &quot;&quot;, /*'null'*/ , &quot;&quot; /* 'not-null'*/]; this.NOT_NULL_OPERATOR = &quot;$notNull&quot;; if (this.attributes != undefined) this.setAttributes(attr); if (filterConditions != undefined) this.setFilter(filterConditions); } Fetch.prototype.toString = function () { var xw = new XMLWriter(true); xw.startElement('fetch'); xw.startElement('entity'); if (this.entityName) { xw.writeAttribute('name', this.entityName.toLowerCase()); } this.serializeAttributes(this.attributes, xw); this.serializeConditions(this.filter, xw); xw.endDocument(); return xw.toString(); }; Fetch.prototype.serializeAttributes = function (value, writer) { for (var i = 0; i &lt; value.length; i++) { var attr = value[i].toLowerCase(); if (attr == &quot;*&quot;) { writer.startElement(&quot;all-attributes&quot;); } else { writer.startElement(&quot;attribute&quot;); writer.writeAttribute(&quot;name&quot;, attr); } writer.endElement(); } }; /** * Sets the filter criteria of the current &lt;i&gt;FetchXml&lt;/i&gt; with the specified values. * * The specified value can be eiher a {@link Filter} object or a conditions object. * * A conditions object is a Javascript object where every property represents a condition. * * If the object contains a property, and that property contains a simple value, like an string or a number, that means property equals to value. * * If you need to specify another operator, then you have to use the form: {attribute:{$operator:value}} * * If the value is an array, then the $in operator is used. * * If the value is a null value, then the nulloperator is applied. For example: {name:null} will retrieve all the records where the name is null. * * @method Fetch#setFilter * @param filterCondition {Filter|object} A Filter object or a Conditions specified in JSON notation. * * @see Build queries with FetchXML: {@link https://msdn.microsoft.com/en-us/library/gg328332.aspx} * * @example &lt;caption&gt;When the simple syntax is used {name:value} then the $eq operator is used. The following filter retrieves all records where the attribute &lt;i&gt;name&lt;/i&gt; is equals to &quot;myAccount&quot;&lt;/caption&gt; * var cond = {name:&quot;myAccount&quot;}; * @example &lt;caption&gt;The following retrieves all records where the attribute &lt;i&gt;name&lt;/i&gt; is equals to &quot;myAccount&quot; &lt;b&gt;AND&lt;/b&gt; the createdon date is equals to the system date&lt;/caption&gt; * var cond = {name:&quot;myAccount&quot;, createdon:new Date()} * @example &lt;caption&gt;If you need to specify additional operators, then use a subobject with the operator name. The following retrieves all records where the attribute &lt;i&gt;name&lt;/i&gt; begins with &quot;contoso%&quot; and the attribute &lt;i&gt;createdon&lt;/i&gt; is bigger than the current date&lt;/caption&gt; * var cond = {name:{$like:&quot;contoso%&quot;}, createdon:{$bt:new Date()}} * @example &lt;caption&gt;Currently supported operators:&lt;/caption&gt; * $eq, $neq, $gt, $ge, $le, $lt, $like, $notlLike, $in, $notIn, $between, $notBetween * @example &lt;caption&gt;If the value is an array, then the &lt;i&gt;in&lt;/i&gt; operator is applied. The wollowing means: where name is one of contoso, acme or cycleworks&lt;/caption&gt; * var cond = {name:[&quot;contoso&quot;, &quot;acme&quot;, &quot;cycleworks&quot;]}; * @example &lt;caption&gt;To specify the null operator, use a null value next to the attribute name. The following will retrieve all the records where the name is null.&lt;/caption&gt; * var cond = {name:null}; * @example &lt;caption&gt;To specify the Not Null operator, use a the &quot;$notNull&quot; value next to the attribute name. The following will retrieve all the records where the name is Not null.&lt;/caption&gt; * var cond = {name:&quot;$notNull&quot;}; */ Fetch.prototype.setFilter = function (filterConditions) { if (filterConditions != null) { if (filterConditions instanceof Filter) { this.filter = filterConditions; } else { this.filter = this.convert(filterConditions); } } }; Fetch.prototype.setAttributes = function (attributes) { if (attributes == null) { this.attributes = []; } else { if (Array.isArray(attributes)) { this.attributes = attributes; } else if (typeof attributes == &quot;string&quot;) { this.attributes = [attributes]; } else if (typeof attributes == &quot;boolean&quot;) { this.attributes = [&quot;*&quot;]; } } }; Fetch.prototype.serializeValue = function (value) { var strValue = &quot;&quot;; if (value !== null &amp;&amp; value !== undefined) { if (value instanceof Date) { var dateValue = value; // TODO: Refactor this awful code var pad2 = function (x) { return String(&quot;00&quot; + x).slice(-2); }; strValue = dateValue.getUTCFullYear() + &quot;-&quot; + pad2(dateValue.getUTCMonth()) + &quot;-&quot; + pad2(dateValue.getUTCDate()) + &quot; &quot; + pad2(dateValue.getUTCHours()) + &quot;:&quot; + pad2(dateValue.getUTCMinutes()) + &quot;:&quot; + pad2(dateValue.getUTCSeconds()); } else { strValue = value + &quot;&quot;; } } return strValue; }; Fetch.prototype.serializeConditions = function (filter, writer) { if (filter &amp;&amp; filter.conditions &amp;&amp; filter.conditions.length &gt; 0) { var filterTypeName = FilterTypes[filter.filterType].toLowerCase(); writer.startElement(&quot;filter&quot;).writeAttribute(&quot;type&quot;, filterTypeName); for (var i = 0; i &lt; filter.conditions.length; i++) { var filterCondition = filter.conditions[i]; var operatorName = this.operatorNames[filterCondition.operator]; var attributeName = filterCondition.attribute.toLowerCase(); writer.startElement(&quot;condition&quot;) .writeAttribute(&quot;attribute&quot;, attributeName) .writeAttribute(&quot;operator&quot;, operatorName); if (filterCondition.values &amp;&amp; filterCondition.values.length &gt; 0) { if (filterCondition.operator == Operators.In || filterCondition.operator == Operators.NotIn || filterCondition.values.length &gt; 1) { for (var j = 0; j &lt; filterCondition.values.length; j++) { var strValue = this.serializeValue(filterCondition.values[j]); writer.startElement(&quot;value&quot;).text(strValue).endElement(); } } else { var strValue = this.serializeValue(filterCondition.values[0]); writer.writeAttribute(&quot;value&quot;, strValue); } } writer.endElement(); // condition; } writer.endElement(); // filter; } }; Fetch.prototype.convert = function (conditionExpression) { var filter = new Filter(); for (var propName in conditionExpression) { var propValue = conditionExpression[propName]; if (propValue == null) { filter.conditions.push(new Condition(propName, Operators.Null)); } else if (propValue == this.NOT_NULL_OPERATOR) { filter.conditions.push(new Condition(propName, Operators.NotNull)); } else if (typeof propValue === 'number' || propValue instanceof Number || typeof propValue === 'string' || propValue instanceof String || typeof propValue === 'boolean' || propValue instanceof Date) { filter.conditions.push(new Condition(propName, Operators.Equal, [propValue])); } else if (Array.isArray(propValue)) { filter.conditions.push(new Condition(propName, Operators.In, propValue)); } else if (typeof propValue === 'object' &amp;&amp; !(propValue instanceof Date)) { for (var i = 0; i &lt; this.operatorJsonNames.length; i++) { var operatorName = this.operatorJsonNames[i]; if (operatorName &amp;&amp; propValue[operatorName] != undefined) { propValue = propValue[operatorName]; if (Array.isArray(propValue)) { filter.conditions.push(new Condition(propName, i, propValue)); } else { filter.conditions.push(new Condition(propName, i, [propValue])); } break; } } } } return filter; }; return Fetch; }()); exports.Fetch = Fetch; /** * Filter Type Values * @typedef {object} FilterTypes * @property {number} And Indicates that all the values in the conditions must be true * @property {number} Or Indicates that only one of the conditions must be true */ var FilterTypes; (function (FilterTypes) { FilterTypes[FilterTypes[&quot;And&quot;] = 0] = &quot;And&quot;; FilterTypes[FilterTypes[&quot;Or&quot;] = 1] = &quot;Or&quot;; })(FilterTypes = exports.FilterTypes || (exports.FilterTypes = {})); var Filter = (function () { /** * Default Constructor * @class Filter * @classdesc Describes a Filter in a {@link Fetch} query. */ /** @member Filter#conditions {Condition[]} Contains the conditions of this filter */ /** @member Filter#filterType {FilterTypes} Indicates if the filter is an And or Or filter */ function Filter(conditions, filterType) { this.conditions = conditions; this.filterType = filterType; if (this.conditions == null) this.conditions = new Array(); if (this.filterType == null) this.filterType = FilterTypes.And; } return Filter; }()); exports.Filter = Filter; // https://msdn.microsoft.com/en-us/library/gg309405.aspx var Operators; (function (Operators) { Operators[Operators[&quot;Equal&quot;] = 0] = &quot;Equal&quot;; Operators[Operators[&quot;NotEqual&quot;] = 1] = &quot;NotEqual&quot;; Operators[Operators[&quot;GreaterThan&quot;] = 2] = &quot;GreaterThan&quot;; Operators[Operators[&quot;GreaterEqual&quot;] = 3] = &quot;GreaterEqual&quot;; Operators[Operators[&quot;LessEqual&quot;] = 4] = &quot;LessEqual&quot;; Operators[Operators[&quot;LessThan&quot;] = 5] = &quot;LessThan&quot;; Operators[Operators[&quot;Like&quot;] = 6] = &quot;Like&quot;; Operators[Operators[&quot;NotLike&quot;] = 7] = &quot;NotLike&quot;; Operators[Operators[&quot;In&quot;] = 8] = &quot;In&quot;; Operators[Operators[&quot;NotIn&quot;] = 9] = &quot;NotIn&quot;; Operators[Operators[&quot;Between&quot;] = 10] = &quot;Between&quot;; Operators[Operators[&quot;NotBetween&quot;] = 11] = &quot;NotBetween&quot;; Operators[Operators[&quot;Null&quot;] = 12] = &quot;Null&quot;; Operators[Operators[&quot;NotNull&quot;] = 13] = &quot;NotNull&quot;; })(Operators = exports.Operators || (exports.Operators = {})); var Condition = (function () { function Condition(attribute, operator, values) { this.attribute = attribute; this.operator = operator; this.values = values; } return Condition; }()); exports.Condition = Condition; //# sourceMappingURL=Fetch.js.map × Search results Close "},"Guid.js.html":{"id":"Guid.js.html","title":"Source: Guid.js","body":" DynamicsNode Classes CRMClientDataTableDataTableJsonSerializerDataTableSerializerDataTableXlsSerializerDataTableXmlSerializerFetchFilterGuid Tutorials CommandsAndReplCompileAndTesting Global Global Source: Guid.js &quot;use strict&quot;; Object.defineProperty(exports, &quot;__esModule&quot;, { value: true }); var Guid = (function () { /** * Default constructor * @classdesc Provides methos to generate an validate GUID values and to convert them from and to a String. * @class Guid * @param {string} string value representing a Guid Value */ function Guid(guid) { if (guid === undefined) { this.value = Guid.EMPTY; } else { if (Guid.isGuid(guid)) { this.value = guid; } else { throw new Error(&quot;Invalid GUID value&quot;); } } } Guid.gen = function (count) { var out = &quot;&quot;; for (var i = 0; i &lt; count; i++) { out += (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1); } return out; }; Guid.prototype.equals = function (other) { // Comparing string `value` against provided `guid` will auto-call // toString on `guid` for comparison if (other instanceof Guid) return this.value == other.getValue(); return Guid.isGuid(other) &amp;&amp; this.value == other; }; ; Guid.prototype.isEmpty = function () { return this.value === Guid.EMPTY; }; ; Guid.prototype.toString = function () { return this.value; }; ; Guid.prototype.toJSON = function () { return this.value; }; ; Guid.prototype.getValue = function () { return this.value; }; Guid.isGuid = function (value) { return value &amp;&amp; (value instanceof Guid || Guid.validator.test(value.toString())); }; ; Guid.create = function () { return new Guid([Guid.gen(2), Guid.gen(1), Guid.gen(1), Guid.gen(1), Guid.gen(3)].join(&quot;-&quot;)); }; ; Guid.raw = function () { return [Guid.gen(2), Guid.gen(1), Guid.gen(1), Guid.gen(1), Guid.gen(3)].join(&quot;-&quot;); }; ; Guid.empty = function () { return new Guid(Guid.EMPTY); }; return Guid; }()); Guid.EMPTY = &quot;00000000-0000-0000-0000-000000000000&quot;; Guid.validator = new RegExp(&quot;^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$&quot;, &quot;i&quot;); exports.Guid = Guid; //# sourceMappingURL=Guid.js.map × Search results Close "},"global.html":{"id":"global.html","title":"Global","body":" DynamicsNode Classes CRMClientDataTableDataTableJsonSerializerDataTableSerializerDataTableXlsSerializerDataTableXmlSerializerFetchFilterGuid Tutorials CommandsAndReplCompileAndTesting Global Global Global Type Definitions FilterTypes Filter Type Values Type: object Properties: Name Type Description And number Indicates that all the values in the conditions must be true Or number Indicates that only one of the conditions must be true Source: Fetch.js, line 197 × Search results Close "},"classes.list.html":{"id":"classes.list.html","title":"Classes","body":" DynamicsNode Classes CRMClientDataTableDataTableJsonSerializerDataTableSerializerDataTableXlsSerializerDataTableXmlSerializerFetchFilterGuid Tutorials CommandsAndReplCompileAndTesting Global Global Classes Classes CRMClient DataTable DataTableJsonSerializer DataTableSerializer DataTableXlsSerializer DataTableXmlSerializer Fetch Filter Guid × Search results Close "},"tutorials.list.html":{"id":"tutorials.list.html","title":"Tutorials","body":" DynamicsNode Classes CRMClientDataTableDataTableJsonSerializerDataTableSerializerDataTableXlsSerializerDataTableXmlSerializerFetchFilterGuid Tutorials CommandsAndReplCompileAndTesting Global Global Tutorials Classes CRMClient DataTable DataTableJsonSerializer DataTableSerializer DataTableXlsSerializer DataTableXmlSerializer Fetch Filter Guid × Search results Close "},"index.html":{"id":"index.html","title":"Index","body":" DynamicsNode Classes CRMClientDataTableDataTableJsonSerializerDataTableSerializerDataTableXlsSerializerDataTableXmlSerializerFetchFilterGuid Tutorials CommandsAndReplCompileAndTesting Global Global Project descriptionDynamicsNode is a library built on node.js that allows you to quickly create scripts to interact with Microsoft Dynamics CRM using JavaScript. The main goal of DynamicsNode is to make you very productive when it comes to automate small tasks in Dynamics CRM. Just create a .js file, add a few lines and execute it. No more .net console applications with all the boilerplate code just for creating one record. Go productive! Github project: https://github.com/crisfervil/DynamicsNode Review the changelog to see the latest changes. How to use itCreate a new directory to store your scripts and cd into it $ mkdir MyScripts &amp;&amp; cd MyScriptsInstall DynamicsNode $ npm install dynamicsnodeWriting codeCreate a new js file named myscript.js and start adding code var dn = require(&quot;dynamicsnode&quot;); // update this with your CRM url and credentials if needed var crm = new dn.CRMClient(&quot;Url=http://crm.contoso.com/xrmContoso&quot;); // retrieve current user information var who = crm.whoAmI(); var myUserInfo = crm.retrieve(&quot;systemuser&quot;,who.UserId); console.log(myUserInfo.fullname); // prints your user name // retrieve a user named John Doe var anotherUser = crm.retrieve(&quot;systemuser&quot;,{fullname:&quot;John Doe&quot;}); console.log(anotherUser); // prints all the attributes of the userSave the file and run the script. In order to run the script use node $ node myscriptFurther information: API How to compile and test the code: Compile and Testing Use it as a command line tool: Commands and Repl RequirementsRequires Node.js This tool is based on Edge and requires .NET Framework 4.5 to be installed. It has been tested in Windows environments only, but could potentially work in Linux too using Mono. Supported CRM versionsTested on CRM 2011, 2013 and CRM Online so far. Volunteers to run the integration tests on other versions are more than welcome :) Backlog(Ordered by priority) [ ] Improve documentation (work In progress) [ ] Add DataTable functions (work in progress) [ ] Refactor to minimize .net code [ ] Increase code coverage [ ] Add paging support in queries [ ] Add async support [ ] Improve Exception handling [ ] Add support for .net core [ ] Make it work in Mono and Linux [ ] Improve Exception Handling to show errors in CRM side [ ] Add functions to work with solutions [ ] Add integration tests for activities [ ] Add an Assert object to allow create integration tests [ ] Add examples page [ ] Add a commands to work with connections [ ] Add more commands to repl mode [ ] Add support for missing operators in condition objects [ ] Add d.ts file to Typings repository [ ] Add functions to create performance tests [ ] Add functions to allow Continuos Integration tools [ ] Add extensibility [x] Improve testeability and integration tests [x] Add import/export commands [x] Add test coverage reports [x] Upload npm package × Search results Close "},"CRMClient.html":{"id":"CRMClient.html","title":"Class: CRMClient","body":" DynamicsNode Classes CRMClientDataTableDataTableJsonSerializerDataTableSerializerDataTableXlsSerializerDataTableXmlSerializerFetchFilterGuid Tutorials CommandsAndReplCompileAndTesting Global Global Class: CRMClient CRMClient Allow access to CRM functions. Contains the functions to interact with CRM services. new CRMClient(connectionString) Default constructor Parameters: Name Type Description connectionString string Optional. A valid connection string or connection string name.The connection string can be either a valid connection string or a name of an existing connection string in the file &quot;config.json&quot; at the root path of your application.If no value is passed to the constructor, the &quot;default&quot; text will be assumed, which means that a connection string named &quot;default&quot; will be used. Source: CRMClient.js, line 16 See: https://msdn.microsoft.com/en-ie/library/mt608573.aspx for further information Examples config.json file format { &quot;connectionStrings&quot;: { &quot;default&quot;:&quot;AuthType=Office365; Url=http://crm.contoso.com/xrmContoso; Domain=CONTOSO; Username=jsmith; Password=passcode&quot;, &quot;connection2&quot;:&quot;AuthType=AD; Url=http://crm.contoso.com/xrmContoso&quot; } } Create a connection using a valid Connection String var crm = new CRMClient(&quot;AuthType=Office365; Url=http://crm.contoso.com/xrmContoso; Domain=CONTOSO; Username=jsmith; Password=passcode&quot;); Create a connection using the connection string named &quot;connection2&quot; specified in the config.json file var crm = new CRMClient(&quot;connection2&quot;); Create a connection using the connection string named &quot;default&quot; specified in the config.json file var crm = new CRMClient(); Create a connection using the connection string named &quot;default&quot; specified in the config.json file var crm = new CRMClient(&quot;default&quot;); Methods create(entityName, attributes) Creates a record in CRM. The names in the entity or attributes are case insensitive, so all the names will be lowercased beforesend the operation to Crm. Parameters: Name Type Description entityName string The name of the entity which record you want to create attributes object Javascript object with the values the new record will have. Source: CRMClient.js, line 310 Returns: GUID of the record created. Type string Examples Create an account named &quot;Contoso&quot; var accountid = crm.create(&quot;account&quot;,{name:&quot;contoso&quot;,description:&quot;this is a test&quot;,AccountCategoryCode:1}); console.log(accountid); Create an email with activity parties var contact1Id = &quot;{6633f95b-c146-45d4-ae99-6bd84f9bf7bc}&quot; var contact2Id = &quot;{6633f95b-c146-45d4-ae99-6bd84f9bf7bc}&quot; var userId = &quot;{6633f95b-c146-45d4-ae99-6bd84f9bf7bc}&quot; var email = { To : [{id:contact1Id,type:&quot;contact&quot;},{id:contact2Id,type:&quot;contact&quot;}], From : [{id:userId,type:&quot;systemuser&quot;}], Subject : &quot;Test Email&quot;, Description : &quot;Test Email&quot;, DirectionCode : true }; var emailId = crm.create(&quot;email&quot;,email); create(data) Creates records in CRM using the rows defined in the DataTable.The id attribute of every created record will be updated with the generated CRM GUID.You need to set the name of the table with the entity name that you want to create. Parameters: Name Type Description data DataTable DataTable with the data to be created in CRM. Source: CRMClient.js, line 335 Example Create a set of accounts using an excel file var accountsToLoad = DataTable.load(&quot;AccountsToLoad.xlsx&quot;); crm.create(accountsToLoad); console.log(accountsToLoad.rows[0].accountid); // This will output the GUID of the created record createIfDoesNotExist(data, matchFields) For every record in the specified Table, tries to find out if it does exists, and if doesn't it creates it. Parameters: Name Type Description data DataTable DataTable with the entity name and the records to create in CRM. matchFields Array.&lt;string&gt; List of fields in the attributes parameter you want to use to know if the record exists in CRM.The attributes specified in this parameter will be used to perform a CRMClient#retrieve. Source: CRMClient.js, line 683 Example Loads a list of accounts from an Excel file and creates only the ones that don't exist already in CRM. It uses the email address to know if the account exists or not. var accountsToLoad = DataTable.load(&quot;AccountsToLoad.xlsx&quot;); crm.createIfDoesNotExist(accountsToLoad,[&quot;emailaddress1&quot;]); createIfDoesNotExist(entityName, attributes, matchFields) Takes a list of attributes and values, tries to find an existing record with those values in CRM, and if doesn't exists it creates it. Parameters: Name Type Description entityName string Name of the entity which record you want to create. attributes object Javascript object with the attributes you want to create. matchFields Array.&lt;string&gt; List of fields in the attributes parameter you want to use to know if the record exists in CRM.The attributes specified in this parameter will be used to perform a CRMClient#retrieve. Source: CRMClient.js, line 693 Examples Create an account named &quot;contoso&quot; only if it doesn't exist one already with the specified email. If theres more than one account with that email, an exception will be thrown crm.createIfDoesNotExist(&quot;account&quot;,{name:&quot;contoso&quot;, description:&quot;New Account Created&quot;, emailaddress1:&quot;info@contoso.com&quot;},[&quot;emailaddress1&quot;]); Searches for an account named &quot;contoso&quot; owned by me. If it doesn't exist, it creates it. var me = crm.whoAmI().UserId; crm.createIfDoesNotExist(&quot;account&quot;,{name:&quot;contoso&quot;, description:&quot;Account Updated&quot;, ownerid:me},[&quot;name&quot;,&quot;ownerid&quot;]); createOrUpdate(entityName, attributes, matchFields) Takes a list of attributes and values, tries to find an existing record with those values in CRM, if it exists,then performs an update, otherwhise it creates it. Parameters: Name Type Description entityName string Name of the entity which record you want to update. attributes object Javascript object with the attributes you want to create or update. matchFields Array.&lt;string&gt; List of fields in the attributes parameter you want to use to know if the record exists in CRM.The attributes specified in this parameter will be used to perform a CRMClient#retrieve. Source: CRMClient.js, line 665 Examples Create an account named &quot;contoso&quot;. In this case, a retrieve of an account with name=&quot;contoso&quot; will be performed. If exists, then the name and description will be updated. If it doesn't exist, then the account will be created with the specified name and description. If theres more than one account with that name, an exception will be thrown crm.createOrUpdate(&quot;account&quot;,{name:&quot;contoso&quot;, description:&quot;Account Updated&quot;},[&quot;name&quot;]); Searches for an account named &quot;contoso&quot; owned by me. If exists, it updates it, otherwhise it creates a new one. var me = crm.whoAmI().UserId; crm.createOrUpdate(&quot;account&quot;,{name:&quot;contoso&quot;, description:&quot;Account Updated&quot;, ownerid:me},[&quot;name&quot;,&quot;ownerid&quot;]); delete(entityName, idsOrConditions) Deletes one on more records in CRM, and returns the number of records affected. Parameters: Name Type Description entityName string Name of the entity which record you want to delete idsOrConditions string | Guid | Array.&lt;string&gt; | object Can be either a Guid, a string, an array or a conditions object.If it is Guid will delete the record with the specified id.If it is a string, must be a Guid value, and again, will delete the records matching the specified id.If the parameter is an array, each element in it must be either a string or a Guid, and in each case, the records deleted will be the ones specified by these Guids.If it is a condition object, first, all the matching records will be retrieved, and then deleted.Learn how to write condition objects: Fetch#setFilter Source: CRMClient.js, line 544 Returns: Number of records deleted Type number Examples Delete an account with a known Guid var affectedRecords = crm.delete(&quot;account&quot;,&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;); Delete an account with a known Guid. A validation of the Guid format will be performed before calling to the method. var affectedRecords = crm.delete(&quot;account&quot;,new Guid(&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;)); Delete several account records at once var affectedRecords = crm.delete(&quot;account&quot;,[&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;,&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;); Delete all existing accounts named &quot;contoso&quot; var affectedRecords = crm.delete(&quot;account&quot;,{name:&quot;contoso&quot;}); &lt;private&gt; getBridge(fakeBridge) Gets the bridge object between node and .net Parameters: Name Type Description fakeBridge boolean indicates if a fake bridge whants to be retrieved Source: CRMClient.js, line 53 Returns: a .net bridge that allows node to interact with .net getEntityMetadata(entityName) Gets metadata information for a particular CRM Entity. Parameters: Name Type Description entityName string Name of the entity which metadata information you want to get Source: CRMClient.js, line 829 Example Retrieve metadata information of the account entity var metadata = crm.getEntityMetadata(&quot;account&quot;); retrieve(entityName, idOrConditions, attributes) Retrieves one single record from CRM. Parameters: Name Type Description entityName string Name of the entity to be retrieved. The name is case insensitive, so all values are lowercased before being sent to CRM. idOrConditions string | Guid | object Either a string with the GUID if the record to be retrieved, a Guid object with the same value, or a conditions object that returns only one record.Learn how to write condition objects: Fetch#setFilter attributes string | Array.&lt;string&gt; | boolean Optional. Either an attribute name, an array of attributes, or a true value indicating that all attributes must be retrieved. The default value is true. An * value has the same effect Source: CRMClient.js, line 135 Returns: A javascript object containing the values of the record. If no data found, then a null object is returned. Examples Return all the columns for the specified account id var account = crm.retrieve(&quot;account&quot;,&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;); console.log(account); Return all the columns for the specified account id var account = crm.retrieve(&quot;account&quot;,&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;,&quot;*&quot;); console.log(account); Return all the columns for the specified account id var account = crm.retrieve(&quot;account&quot;,&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;,true); console.log(account); You can use the Guid class to specify the id parameter. This allows to perform a GUID format validation before calling the method. var Guid = require(&quot;dynamicsnode&quot;).Guid; var account = crm.retrieve(&quot;account&quot;,new Guid(&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;)); console.log(account); Get the accountid,name,ownerid,createdon columns for the given account id var account = crm.retrieve(&quot;account&quot;,&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;,[&quot;accountid&quot;,&quot;name&quot;,&quot;ownerid&quot;,&quot;createdon&quot;]); console.log(account); Get the name of the specified account var account = crm.retrieve(&quot;account&quot;,&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;,&quot;name&quot;); console.log(account.name); Accessing information about a related record var account = crm.retrieve(&quot;account&quot;,&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;,&quot;ownerid&quot;); console.log(account.ownerid); // outputs the GUID value console.log(account.ownerid_type); // outputs systemuser console.log(account.ownerid_name); // outputs John Doe Returns an account using a condition object. If there are more than one account named &quot;Acme&quot; then an exception will be thrown var account = crm.retrieve(&quot;account&quot;,{name:&quot;Acme&quot;}); console.log(account.name); retrieveAll(entityName) It is a simpified way of retrieving all the existing records of an entity. Is equivalent to call the CRMClient#retrieveMultiple method not specifying the conditions or attributes method Parameters: Name Type Description entityName string Name of the entity which records you want to retrieve. Source: CRMClient.js, line 297 Returns: DataTable object with the records found. Type DataTable Example Retrieve all existing account records var accounts = crm.retrieveAll(&quot;account&quot;); retrieveMultiple(entityNameOrFetchXml, conditions, attributes) Retrieves one or more records of the specified entity that fulfill the specified conditions. Parameters: Name Type Description entityNameOrFetchXml string Name of the entity or Fetch Xml query to specify the records to be retrieved. More info: https://msdn.microsoft.com/en-us/library/gg328332.aspx conditions object Optional. In case you don't want to write a FetchXml to specify the records to retrieve, you can use a conditions object to specify the criteria to retrieve records. If you omit this parameter, all the existing records of the specified entity will be retrieved; omitting this parameter is equivalent to write a FetchXml without any filter conditions.Learn how to write condition objects: Fetch#setFilter attributes string | Array.&lt;string&gt; | boolean Optional. Either an attribute name, an array of attributes, or a true value indicating that all attributes must be retrieved. The default value is true. An * value has the same effect Source: CRMClient.js, line 246 See: Build queries with FetchXML: https://msdn.microsoft.com/en-us/library/gg328332.aspx Returns: DataTable object with the records found. Type DataTable Examples Retrieves all the records of the account entity. Only the accountid column will be retrieved (the id column is always returned in all Crm queries) var accounts = crm.retrieveMultiple(&quot;&lt;fetch&gt;&lt;entity name='account'&gt;&lt;/entity&gt;&lt;/fetch&gt;&quot;); Retrieves all the records of the account entity. Includes also all the columns of the entity. var accounts = crm.retrieveMultiple(&quot;account&quot;); Retrieves all the records of the account entity where the account name is equals to &quot;contoso&quot;. Returns all the columns of the entity. var accounts = crm.retrieveMultiple(&quot;account&quot;,{name:&quot;contoso&quot;}); Retrieves all the records of the account entity where the account name is equals to &quot;contoso&quot;, but only the specified columns are included in the query. var accounts = crm.retrieveMultiple(&quot;account&quot;,{name:&quot;contoso&quot;},[&quot;accountid&quot;,&quot;name&quot;,&quot;ownerid&quot;,&quot;createdon&quot;]); Retrieves all the records of the account entity where the account name is equals to &quot;contoso&quot; or &quot;acme&quot;. Returns all the columns of the entity. var accounts = crm.retrieveMultiple(&quot;account&quot;,{name:[&quot;contoso&quot;,&quot;acme&quot;]}); setState(entityName, entityId, state, status) Sets the state and status of a record. Parameters: Name Type Description entityName string Name of the entity which state or status you want to set entityId Guid | string GUID of the record which state or status you want to set state number | string Name or Value of the State you want to set status number | string Name or Value of the Status you want to set Source: CRMClient.js, line 857 Examples Set the state of a task to Completed (1) and the Status to Completed (5) crm.setState('task','6fefeb79-5447-e511-a5db-0050568a69e2',1,5); Set the state of a task using the text values crm.setState('task','6fefeb79-5447-e511-a5db-0050568a69e2','Completed','Completed'); testConnection() Tests the active connection. Throws an exception if there's any error.The method performs a WhoAmIRequest. Source: CRMClient.js, line 120 See: CRMClient#whoAmI update(entityName, attributes, conditions) Updates one or more records that meet the specified conditions and returns the number of updated records. Parameters: Name Type Description entityName string The name of the entity which record you want to update. attributes object Javascript object with the values the new record will have. conditions opbject Optional. Javascript condition object with the filter values that is going to be used to know which records are going to be updated.If you omit this parameter, then you have to provide the record GUID in the attributes parameter.Learn how to write condition objects: Fetch#setFilter Source: CRMClient.js, line 608 Returns: Number of modified records Type number Examples Updates all the accounts which name is contoso, and set the attribute value to &quot;contoso-updated&quot; var affectedRecords = crm.update(&quot;account&quot;,{name:&quot;contoso-updated&quot;},{name:&quot;contoso&quot;}) In this example, only the account with the specified account id will be updated. If the specified record id exists, then affectedRecords will be equals to 1. var affectedRecords = crm.update(&quot;account&quot;,{accountid:&quot;6fefeb79-5447-e511-a5db-0050568a69e2&quot;,name:&quot;contoso-updated&quot;}) whoAmI() Returns information about the current user. Useful for testing the active connection. Source: CRMClient.js, line 105 Returns: a WhoAmIResponse object with the information about the authenticated user in CRM. Example Returns information about the current user var who = crm.whoAmI(); console.log(who.BusinessUnitId); // prints 6fefeb79-5447-e511-a5db-0050568a69e2 console.log(who.OrganizationId); // prints 2b476bd1-aaed-43ee-b386-eee0f1b87207 console.log(who.UserId); // prints 9ba35c25-b892-4f8a-b124-3920d9873af4 × Search results Close "},"DataTable.html":{"id":"DataTable.html","title":"Class: DataTable","body":" DynamicsNode Classes CRMClientDataTableDataTableJsonSerializerDataTableSerializerDataTableXlsSerializerDataTableXmlSerializerFetchFilterGuid Tutorials CommandsAndReplCompileAndTesting Global Global Class: DataTable DataTable Represents a DataTable object. Contains methods to save and load the row values from a file. new DataTable() Default constructor Source: DataTable.js, line 6 Methods &lt;static&gt; load(string) Loads the DataTable object from the specified file. Parameters: Name Type Description string fileName File path where to save the DataTable object. The path is relative to process.cwd() Source: DataTable.js, line 144 Example Loads the table from an xlsx file var dt = DataTable.load('mydata.xlsx'); lookup(columnName, updater) Method to convert all the existing values in a column.Iterates through all the existing rows, and for every value in the specified column calls to the specified callback method.Then, the returning value will be applied to the column.The idea behind this functionality is that you can resolve the lookup data that you may have in a DataTable, before sendingthose values to CRM.For example, you may want to load a list of contacts, and you want to associate your contacts to existing parent accounts.What you can do, is use the phone number on the contact to try to find the parent account of the contact. Parameters: Name Type Description columnName string Name of the column which values are going to be updated updater DataTable~lookupCallback Function that will process every record in the Table. Source: DataTable.js, line 23 Examples Lookup using simple values var dt = new DataTable(); dt.rows.push({val1:1,val2:2}, {val1:2,val2:2}); dt.lookup('val1',row=&gt;++row.val1); console.log(dt.rows[0].val1); // prints out 2 console.log(dt.rows[1].val1); // prints out 3 Find the parent account of a contact using the phone number // create a contact using a data table and associate to the create account using the phone number var dtContacts = DataTable.load(&quot;MyContactsToLoad.json&quot;); // resolve the parentcustomerid field dtContacts.lookup(&quot;parentcustomerid&quot;,row=&gt;{ return {id:crm.retrieve(&quot;account&quot;,{telephone1:row.telephone1}).accountid,type:&quot;account&quot;}}); // create the record crm.create(dtContacts); removeColumn(columnName) Removes a column from the Table Parameters: Name Type Description columnName string Name of the column to remove Source: DataTable.js, line 81 Example Remove an existing column var dt = new DataTable(); dt.rows.push({val1:1,val2:2}, {val1:2,val2:2}); dt.removeColumn('val1'); console.log(dt.rows[0].val1); // prints undefined console.log(dt.rows[1].val1); // prints undefined console.log(dt.rows[0].val2); // prints 2 console.log(dt.rows[1].val2); // prints 2 rename(columnName, newName) Renames an existing column in the Table Parameters: Name Type Description columnName string Name of the existing column to rename newName string New Name to apply to the column Source: DataTable.js, line 99 Example Rename an existing column var dt = new DataTable(); dt.rows.push({val1:1,val2:2}, {val1:2,val2:2}); dt.renameColumn('val1','val3'); console.log(dt.rows[0].val1); // prints undefined console.log(dt.rows[1].val1); // prints undefined console.log(dt.rows[0].val2); // prints 2 console.log(dt.rows[1].val2); // prints 2 console.log(dt.rows[0].val3); // prints 1 console.log(dt.rows[1].val3); // prints 2 save(DataTable, string) Saves the specified datatable object to the specified file.The format of the file depends on the extension provided.The supported formats are json, xml and xlsx. Parameters: Name Type Description DataTable dataTable Table to save to the specified file. string fileName File path where to save the DataTable object. The path is relative to process.cwd() Source: DataTable.js, line 123 Example Saves the datatable to a .json file var dt = new DataTable(); dt.save('mydata.json'); Type Definitions lookupCallback(row) Callback that receives a row of a data table and returns a value for a column Parameters: Name Type Description row object Object containing the values of a row Source: DataTable.js, line 17 Returns: The value to apply to a specific column of that particular row Type object × Search results Close "},"DataTableJsonSerializer.html":{"id":"DataTableJsonSerializer.html","title":"Class: DataTableJsonSerializer","body":" DynamicsNode Classes CRMClientDataTableDataTableJsonSerializerDataTableSerializerDataTableXlsSerializerDataTableXmlSerializerFetchFilterGuid Tutorials CommandsAndReplCompileAndTesting Global Global Class: DataTableJsonSerializer DataTableJsonSerializer Saves and loads a DataTable object to and from an json file. new DataTableJsonSerializer() Default constructor Source: DataTableJsonSerializer.js, line 3 Methods deserialize() Deserializes the specified buffer data into a DataTable object Source: DataTableJsonSerializer.js, line 17 serialize() Serializes the specified DataTable object into a Buffer data. Source: DataTableJsonSerializer.js, line 11 × Search results Close "},"DataTableSerializer.html":{"id":"DataTableSerializer.html","title":"Class: DataTableSerializer","body":" DynamicsNode Classes CRMClientDataTableDataTableJsonSerializerDataTableSerializerDataTableXlsSerializerDataTableXmlSerializerFetchFilterGuid Tutorials CommandsAndReplCompileAndTesting Global Global Class: DataTableSerializer DataTableSerializer Utility to load and save DataTable objects to different file formats.More Info: DataTableJsonSerializer DataTableXlsSerializer DataTableXmlSerializer new DataTableSerializer() Default constructor Source: DataTableSerializer.js, line 8 × Search results Close "},"DataTableXlsSerializer.html":{"id":"DataTableXlsSerializer.html","title":"Class: DataTableXlsSerializer","body":" DynamicsNode Classes CRMClientDataTableDataTableJsonSerializerDataTableSerializerDataTableXlsSerializerDataTableXmlSerializerFetchFilterGuid Tutorials CommandsAndReplCompileAndTesting Global Global Class: DataTableXlsSerializer DataTableXlsSerializer Saves and loads a DataTable object to and from a MS Excel file (xlsx).When reading from an Excel file, the data is taken from the first sheet in the workbook.It is assumed that the first row contains the column names.When serializing, the name of the sheet containing the data will be the name in the DataTable object. new DataTableXlsSerializer() Default constructor Source: DataTableXlsSerializer.js, line 15 Methods deserialize() Deserializes the specified buffer data into a DataTable object Source: DataTableXlsSerializer.js, line 103 serialize() Serializes the specified DataTable object into a Buffer data. Source: DataTableXlsSerializer.js, line 26 × Search results Close "},"DataTableXmlSerializer.html":{"id":"DataTableXmlSerializer.html","title":"Class: DataTableXmlSerializer","body":" DynamicsNode Classes CRMClientDataTableDataTableJsonSerializerDataTableSerializerDataTableXlsSerializerDataTableXmlSerializerFetchFilterGuid Tutorials CommandsAndReplCompileAndTesting Global Global Class: DataTableXmlSerializer DataTableXmlSerializer Saves and loads a DataTable object to and from an Xml file. new DataTableXmlSerializer() Default constructor Source: DataTableXmlSerializer.js, line 7 Methods deserialize() Deserializes the specified buffer data into a DataTable object Source: DataTableXmlSerializer.js, line 57 serialize() Serializes the specified DataTable object into a Buffer data. Source: DataTableXmlSerializer.js, line 15 × Search results Close "},"Fetch.html":{"id":"Fetch.html","title":"Class: Fetch","body":" DynamicsNode Classes CRMClientDataTableDataTableJsonSerializerDataTableSerializerDataTableXlsSerializerDataTableXmlSerializerFetchFilterGuid Tutorials CommandsAndReplCompileAndTesting Global Global Class: Fetch Fetch Provides properties and methods to create FetchXml queries new Fetch(entityName, attr, filterConditions) Default Constructor Parameters: Name Type Description entityName string Optional. Name of the entity which the query is for attr string | boolean | Array.&lt;string&gt; Optional. Either a column name, or a list of column names, or a boolean value indicating that all the attribute values want to be retrieved. The default value is null, and means that only the primary attribute will be retrieved. filterConditions object Optional. Object that describes conditions in an JSON notation. More Info: Fetch#setFilter Source: Fetch.js, line 5 Examples Create an empty FetchXml var fetch = new Fetch(); console.log(fetch.toString()); // outputs: &lt;fetch&gt;&lt;entity&gt;&lt;/entity&gt;&lt;/fetch&gt; Create a Fetch query for the &quot;account&quot;&quot; entity, with 3 attributes and one filter var fetch = new Fetch(&quot;account&quot;,[&quot;description&quot;,&quot;createdon&quot;,&quot;ownerid&quot;],{name:&quot;acme&quot;}); Create a Fetch query for the &quot;account&quot;&quot; entity, with all attributes and one filter var fetch = new Fetch(&quot;account&quot;,true,{name:&quot;acme&quot;}); Methods setFilter(filterCondition) Sets the filter criteria of the current FetchXml with the specified values. The specified value can be eiher a Filter object or a conditions object. A conditions object is a Javascript object where every property represents a condition. If the object contains a property, and that property contains a simple value, like an string or a number, that means property equals to value. If you need to specify another operator, then you have to use the form: {attribute:{$operator:value}} If the value is an array, then the $in operator is used. If the value is a null value, then the nulloperator is applied. For example: {name:null} will retrieve all the records where the name is null. Parameters: Name Type Description filterCondition Filter | object A Filter object or a Conditions specified in JSON notation. Source: Fetch.js, line 55 See: Build queries with FetchXML: https://msdn.microsoft.com/en-us/library/gg328332.aspx Examples When the simple syntax is used {name:value} then the $eq operator is used. The following filter retrieves all records where the attribute name is equals to &quot;myAccount&quot; var cond = {name:&quot;myAccount&quot;}; The following retrieves all records where the attribute name is equals to &quot;myAccount&quot; AND the createdon date is equals to the system date var cond = {name:&quot;myAccount&quot;, createdon:new Date()} If you need to specify additional operators, then use a subobject with the operator name. The following retrieves all records where the attribute name begins with &quot;contoso%&quot; and the attribute createdon is bigger than the current date var cond = {name:{$like:&quot;contoso%&quot;}, createdon:{$bt:new Date()}} Currently supported operators: $eq, $neq, $gt, $ge, $le, $lt, $like, $notlLike, $in, $notIn, $between, $notBetween If the value is an array, then the in operator is applied. The wollowing means: where name is one of contoso, acme or cycleworks var cond = {name:[&quot;contoso&quot;, &quot;acme&quot;, &quot;cycleworks&quot;]}; To specify the null operator, use a null value next to the attribute name. The following will retrieve all the records where the name is null. var cond = {name:null}; To specify the Not Null operator, use a the &quot;$notNull&quot; value next to the attribute name. The following will retrieve all the records where the name is Not null. var cond = {name:&quot;$notNull&quot;}; × Search results Close "},"Filter.html":{"id":"Filter.html","title":"Class: Filter","body":" DynamicsNode Classes CRMClientDataTableDataTableJsonSerializerDataTableSerializerDataTableXlsSerializerDataTableXmlSerializerFetchFilterGuid Tutorials CommandsAndReplCompileAndTesting Global Global Class: Filter Filter Describes a Filter in a Fetch query. new Filter() Default Constructor Source: Fetch.js, line 209 Members conditions :Array.&lt;Condition&gt; Contains the conditions of this filter Type: Array.&lt;Condition&gt; Source: Fetch.js, line 214 filterType :FilterTypes Indicates if the filter is an And or Or filter Type: FilterTypes Source: Fetch.js, line 215 × Search results Close "},"Guid.html":{"id":"Guid.html","title":"Class: Guid","body":" DynamicsNode Classes CRMClientDataTableDataTableJsonSerializerDataTableSerializerDataTableXlsSerializerDataTableXmlSerializerFetchFilterGuid Tutorials CommandsAndReplCompileAndTesting Global Global Class: Guid Guid Provides methos to generate an validate GUID values and to convert them from and to a String. new Guid(string) Default constructor Parameters: Name Type Description string string value representing a Guid Value Source: Guid.js, line 4 × Search results Close "},"tutorial-CommandsAndRepl.html":{"id":"tutorial-CommandsAndRepl.html","title":"Tutorial: CommandsAndRepl","body":" DynamicsNode Classes CRMClientDataTableDataTableJsonSerializerDataTableSerializerDataTableXlsSerializerDataTableXmlSerializerFetchFilterGuid Tutorials CommandsAndReplCompileAndTesting Global Global CommandsAndRepl CommandsCommands are a way to use Dynamics Node from command line. In order to use those commands, you have to install DynamicsNode in global mode. To install DynamicsNode in global mode use the following command. $ npm install -g dynamicsnodeExportExports the data of the specified entity to the specified file using the specified connection. Usage: $ dynamicsnode export -e [entityName] -f [file] -c [connection]This will export all the existing accounts to the accounts.xml file. You can specify either an xml or a json file. CRMOnline is the connection string or the connection name to use. In order to reference connections using a name, create a file config.json at the root of your scripts folder. The config.json must have the following format: { &quot;connectionStrings&quot;: { &quot;default&quot;:&quot;Url=https://contoso.crm4.dynamics.com&quot;, &quot;CRMOnline&quot;:&quot;Url=https://contoso.crm4.dynamics.com; Username=admin@contoso.onmicrosoft.com; Password=YourPassword;&quot; } }Each name inside connectionStrings is a name you can use in your export command. Import$ dynamicsnode import -f [fileName] -c [connection]This command imports the contents of the specified file into CRM. As in the export command, you can specify any connection name in the config.json file. The specified file can be an .xml or .json file. Each one has a very specific format. The easiest way to review this format is generate it through the export command. Repl integration$ dynamicsnode replThis command initiates Dynamics Node in repl mode. This means, that you can interact with CRM using the existing API and evaluating the code as you type it. × Search results Close "},"tutorial-CompileAndTesting.html":{"id":"tutorial-CompileAndTesting.html","title":"Tutorial: CompileAndTesting","body":" DynamicsNode Classes CRMClientDataTableDataTableJsonSerializerDataTableSerializerDataTableXlsSerializerDataTableXmlSerializerFetchFilterGuid Tutorials CommandsAndReplCompileAndTesting Global Global CompileAndTesting How to compile the codePrerequisitesIn order to build the TypeScript compiler, ensure that you have Git and Node.js installed. StepsFirst, get the latest version of the code from Github, either using the clone button from the web, or using the command line. $ git clone https://github.com/crisfervil/DynamicsNode.gitThen, cd into the cloned directory $ cd DynamicsNodeInstall dependencies using npm $ npm installRun the build script $ npm run buildHow to run testsUse the default npm command for testing. $ npm testDebugIn order to see debug information in console, type following command: set DEBUG=dynamicsnodeYou should see debug information like this: dynamicsnode Exporting account to accounts.xml +0ms dynamicsnode Getting metadata... +0ms dynamicsnode Getting data... +1s dynamicsnode Saving... +531ms dynamicsnode done! +32msIntegration TestsIn order to run the integration tests, first clone and compile the code as described above. Then, you need create a config.json file in the root of DynamicsNode folder. The config.json must have the following format: { &quot;connectionStrings&quot;: { &quot;IntegrationTestsOnline&quot;:&quot;Url=https://contoso.crm4.dynamics.com; Username=admin@contoso.onmicrosoft.com; Password=YourPassword;&quot; } }You need to create a connection string named &quot;IntegrationTestsXXXX&quot; where XXXX is whatever name you want to use to indentify your connection. After doing that, just re-run tests script with npm. $ npm testYou should see something like this: c:\\GitHub\\DynamicsNode&gt;npm test &gt; dynamicsnode@0.0.4 test c:\\GitHub\\DynamicsNode &gt; mocha --recursive CRMClient √ Throws an exception with an invalid connection (169ms) √ Tells who I am (148ms) √ Creates a record (153ms) √ Deletes a record (147ms) √ Updates a record (137ms) √ Associates two records (169ms) √ Disassociates two records (163ms) √ Gets entity metadata (153ms) DataTable √ Initializes from an existing Array √ Loads and read JSON data √ Loads and reads XML data Fetch √ Serializes a simple Fetch √ Serializes a simple Fetch with conditions √ Serializes a complex Fetch Guid √ Creates an instance of non empty Guid √ Creates an instance of empty Guid √ Creates an instance from a string √ Validates Guid format on creation √ Generates new Guids √ Compares two different Guids √ Compares two equal Guids √ Compares a Guid value with a string Integration tests: IntegrationTestsOnline √ Throws an exception with an invalid connection (169ms) √ Creates an account (937ms) √ Updates an account (588ms) √ Updates an account using a criteria (1740ms) √ Knows Who I am (68ms) √ Performs a simple retrieve (139ms) √ Performs a retrieve that doesnt returns any records (134ms) √ Performs a retrieve that doesnt returns any records using a GUID (100ms) √ Performs a retrieve with specific columns (139ms) √ Performs a retrieve with all columns (131ms) √ Performs a &quot;retrieve all&quot; of an entity (134ms) √ Performs a simple retrieve multiple (185ms) √ Performs a retrieve all (154ms) √ Associates and Disassociates a lead and an contact (434ms) √ Associates and Disassociates a lead and an contact using a DataTable (440ms) √ Gets entity metadata - Export and import users to a File 38 passing (7s) 1 pending × Search results Close "}}
    </script>

    <script type="text/javascript">
        $(document).ready(function() {
            Searcher.init();
        });

        $(window).on("message", function(msg) {
            var msgData = msg.originalEvent.data;

            if (msgData.msgid != "docstrap.quicksearch.start") {
                return;
            }

            var results = Searcher.search(msgData.searchTerms);

            window.parent.postMessage({"results": results, "msgid": "docstrap.quicksearch.done"}, "*");
        });
    </script>
</body>
</html>
